# チャット成果物のワークスペース連携機能 - タスク指示書

## メタ情報

| 項目             | 内容                                   |
| ---------------- | -------------------------------------- |
| タスクID         | TASK-CHAT-WS-EXPORT-001                |
| タスク名         | チャット成果物のワークスペース連携機能 |
| 分類             | 新規機能                               |
| 対象機能         | チャット・ワークスペース               |
| 優先度           | 高                                     |
| 見積もり規模     | 中規模                                 |
| ステータス       | 未実施                                 |
| 発見元           | ユーザー要望                           |
| 発見日           | 2025-12-11                             |
| 発見エージェント | @product-manager                       |

---

## 1. なぜこのタスクが必要か（Why）

### 1.1 背景

チャットでLLMと対話して生成した成果物（コード、文章、設定ファイル等）をワークスペースに保存し、実際のプロジェクトで活用したい。チャットとワークスペースを連携することで、生成から活用までのワークフローがシームレスになる。

### 1.2 問題点・課題

- チャットで生成したコードをコピー&ペーストで移す必要がある
- 成果物の管理が煩雑
- チャットとワークスペースが分断されている

### 1.3 放置した場合の影響

- 作業効率が低下
- 成果物の管理が困難
- ワークフローが断片化

---

## 2. 何を達成するか（What）

### 2.1 目的

チャットで生成した成果物をワークスペースに直接保存・連携できる機能を実装する。

### 2.2 最終ゴール

- チャット内のコードブロックをワークスペースに保存
- 保存先の選択・新規ファイル作成
- 既存ファイルへの追記・上書き
- チャット履歴全体のワークスペース保存
- ワークスペースからチャットへの参照

### 2.3 スコープ

#### 含むもの

**コードブロック保存**

- コードブロックの「保存」ボタン
- 保存先パスの選択ダイアログ
- 新規ファイル作成
- 既存ファイルへの追記/上書き選択
- 言語に応じた拡張子の自動設定

**チャット履歴保存**

- 会話全体をMarkdownとして保存
- 選択範囲のみの保存
- メタデータ（日時、LLM、プロンプト）の含める/含めない選択

**ワークスペース連携**

- 保存先フォルダの指定
- プロジェクト構造に沿った保存
- 保存後のファイルをエディターで開く

#### 含まないもの

- 自動保存（手動操作が必要）
- Git連携（別タスク）
- 外部ストレージへの保存

### 2.4 成果物

- コードブロック保存UI
- 保存先選択ダイアログ
- ファイル保存ロジック
- 関連するユニットテスト

---

## 3. 主要な使用エージェント

- **@ui-designer**: 保存UI・ダイアログの設計
- **@electron-architect**: ファイルシステム連携
- **@logic-dev**: 保存ロジック
- **@state-manager**: チャット・ワークスペース状態連携

---

## 4. 完了条件チェックリスト

- [ ] コードブロックをワークスペースに保存できる
- [ ] 保存先を選択・新規作成できる
- [ ] 既存ファイルへの追記/上書きができる
- [ ] チャット履歴全体を保存できる
- [ ] 保存後にエディターで開ける

---

## 5. 備考

### レビュー指摘の原文

```
このチャットの履歴をワークスペースの方に渡せたりできるようなシステムを構築したいです。
このチャットでやり取りした成果物をワークスペースの方に保存するような新規作成してそちらの方に保存するというような形を取りたいです。
```

### 関連タスク

- TASK-CHAT-HISTORY-001: チャット履歴永続化機能
- TASK-WS-CHAT-EDIT-001: ワークスペースファイルのチャット編集機能
