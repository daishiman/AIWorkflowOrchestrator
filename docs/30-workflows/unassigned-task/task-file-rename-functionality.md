# ファイル・ディレクトリ名変更機能 - タスク指示書

## メタ情報

| 項目             | 内容                             |
| ---------------- | -------------------------------- |
| タスクID         | TASK-FILE-RENAME-001             |
| タスク名         | ファイル・ディレクトリ名変更機能 |
| 分類             | 新規機能                         |
| 対象機能         | ワークスペース・ファイルツリー   |
| 優先度           | 中                               |
| 見積もり規模     | 小規模                           |
| ステータス       | 未実施                           |
| 発見元           | ユーザー要望                     |
| 発見日           | 2025-12-11                       |
| 発見エージェント | @product-manager                 |

---

## 1. なぜこのタスクが必要か（Why）

### 1.1 背景

ワークスペース内でファイルやディレクトリを管理する際、名前の変更は基本的な操作である。現在、ファイル・ディレクトリ名を変更するには外部のファイルマネージャーを使用する必要があり、作業効率が低下している。

### 1.2 問題点・課題

- ファイル名・ディレクトリ名の変更にコンテキストスイッチが発生
- 外部ツールを使用する必要がある
- ワークスペースの一貫した操作体験が損なわれている
- リファクタリング作業時のファイル名変更が煩雑

### 1.3 放置した場合の影響

- ユーザーの作業効率が低下する
- ワークスペースの操作体験が不完全
- 競合製品と比較して機能的に劣る
- ファイル管理作業が煩雑になる

---

## 2. 何を達成するか（What）

### 2.1 目的

ワークスペースのファイルツリー内で直接ファイル名・ディレクトリ名を変更できるようにする。

### 2.2 最終ゴール

- ファイルツリー内でファイル名を直接変更できる
- ディレクトリ名も同様に変更できる
- 変更時のバリデーション（重複チェック、禁止文字チェック）
- 変更失敗時の適切なエラーハンドリング
- アンドゥ機能（オプション）

### 2.3 スコープ

#### 含むもの

- ファイル名のインライン編集
- ディレクトリ名のインライン編集
- 右クリックメニューからの名前変更
- F2キーによる名前変更開始
- バリデーション（重複、禁止文字、空文字）
- エラーメッセージ表示

#### 含まないもの

- ファイルの移動機能
- 複数ファイルの一括リネーム
- 正規表現によるリネーム
- リネーム履歴管理

### 2.4 成果物

- リネーム機能付きファイルツリーコンポーネント
- リネームバリデーションロジック
- 関連するユニットテスト
- 技術ドキュメント

---

## 3. どのように実行するか（How）

### 3.1 前提条件

- プロジェクトの開発環境がセットアップ済み
- ファイルツリーコンポーネントが実装済み
- Electronファイルシステムアクセスの理解

### 3.2 依存タスク

- なし（独立したタスク）

### 3.3 必要な知識・スキル

- React/TypeScript
- Electron（ファイルシステム操作）
- UI/UXデザイン

### 3.4 推奨アプローチ

1. インライン編集コンポーネントの設計
2. ファイルシステム操作ロジックの実装
3. バリデーションロジックの実装
4. キーボードショートカット対応

---

## 4. 実行手順

### Phase構成

```
Phase 0: 要件定義
Phase 1: 設計
Phase 2: 設計レビューゲート
Phase 3: テスト作成（TDD: Red）
Phase 4: 実装（TDD: Green）
Phase 5: リファクタリング（TDD: Refactor）
Phase 6: 品質保証
Phase 7: 最終レビューゲート
Phase 8: 手動テスト検証
Phase 9: ドキュメント更新
```

### 主要な使用エージェント

- **@ui-designer**: インライン編集UIの設計・実装
- **@electron-architect**: ファイルシステム操作の設計
- **@unit-tester**: TDDでのテスト作成
- **@electron-security**: ファイル操作のセキュリティ検証

---

## 5. 完了条件チェックリスト

### 機能要件

- [ ] ダブルクリックで名前変更モードに入れる
- [ ] F2キーで名前変更モードに入れる
- [ ] 右クリックメニューから名前変更できる
- [ ] Enterで変更確定、Escでキャンセル
- [ ] 重複ファイル名のエラー表示
- [ ] 禁止文字のエラー表示

### 品質要件

- [ ] 全テストがPASS
- [ ] Lintエラーなし
- [ ] 型エラーなし

---

## 6. リスクと対策

| リスク               | 影響度 | 発生確率 | 対策                     |
| -------------------- | ------ | -------- | ------------------------ |
| ファイル操作の失敗   | 高     | 低       | 適切なエラーハンドリング |
| パーミッションエラー | 中     | 中       | 権限チェックとエラー表示 |

---

## 7. 備考

### レビュー指摘の原文

```
ファイル名やディレクトリ名を変更する機能も追加してほしいです。
```
