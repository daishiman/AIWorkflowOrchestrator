# WorkspaceFileSelector 手動テスト実施ガイド

## 📋 テスト実行環境

### 前提条件

- Node.js環境が正常に動作していること
- pnpmがインストールされていること
- リポジトリが正常にクローンされていること

### 開発サーバー起動手順

```bash
# ワークツリーディレクトリに移動
cd /Users/dm/dev/dev/個人開発/AIWorkflowOrchestrator/.worktrees/task-1766023279741-f4ea87

# デスクトップアプリ開発サーバー起動
pnpm --filter @repo/desktop dev
```

**起動確認ポイント:**

- Electronウィンドウが正常に起動すること
- コンソールにエラーが表示されていないこと
- WorkspaceFileSelectorコンポーネントが表示されること

---

## 🧪 手動テストケース詳細

### テストケース 1: フォルダ一括選択

**目的:** フォルダのチェックボックスをクリックした際、そのフォルダ配下の全ファイルが選択されることを確認

**事前条件:**

- WorkspaceFileSelectorが表示されていること
- テスト用のフォルダ構造が存在するこ と（複数ファイルを含むフォルダ）

**実行手順:**

1. フォルダツリーを展開し、複数のファイルを含むフォルダを表示
2. 対象フォルダのチェックボックスをクリック（未選択 → 選択状態へ）
3. フォルダを展開して配下のファイルの選択状態を確認
4. 右パネルの選択ファイル一覧を確認

**期待結果:**

- [ ] フォルダのチェックボックスがチェック状態になる
- [ ] フォルダアイコンが塗りつぶし状態になる
- [ ] フォルダ配下の全ファイルのチェックボックスがチェック状態になる
- [ ] 選択ファイル一覧に配下の全ファイルが追加される
- [ ] 選択ファイル数カウントが正しく増加する

**スクリーンショット撮影ポイント:**

- クリック前の状態（未選択）
- クリック後のフォルダ展開状態（全ファイル選択）
- 右パネルの選択ファイル一覧

---

### テストケース 2: フォルダ一括解除

**目的:** 選択済みフォルダのチェックボックスをクリックした際、そのフォルダ配下の全ファイルが解除されることを確認

**事前条件:**

- テストケース1が完了していること
- フォルダとその配下のファイルが全て選択されていること

**実行手順:**

1. 選択済みフォルダのチェックボックスをクリック（選択 → 未選択状態へ）
2. フォルダを展開して配下のファイルの選択状態を確認
3. 右パネルの選択ファイル一覧を確認

**期待結果:**

- [ ] フォルダのチェックボックスが未チェック状態になる
- [ ] フォルダアイコンが通常状態になる
- [ ] フォルダ配下の全ファイルのチェックボックスが未チェック状態になる
- [ ] 選択ファイル一覧から配下の全ファイルが削除される
- [ ] 選択ファイル数カウントが正しく減少する

**スクリーンショット撮影ポイント:**

- クリック前の状態（全選択）
- クリック後のフォルダ展開状態（全解除）
- 右パネルの選択ファイル一覧（ファイルが削除されている）

---

### テストケース 3: indeterminate状態表示

**目的:** フォルダ配下の一部ファイルのみが選択されている場合、フォルダがindeterminate状態（部分選択）で表示されることを確認

**事前条件:**

- 3つ以上のファイルを含むフォルダが存在すること
- 全てのファイルが未選択状態であること

**実行手順:**

1. フォルダを展開
2. フォルダ配下のファイルの**一部だけ**（例: 3つ中2つ）をチェック
3. フォルダのチェックボックスとアイコンの状態を確認

**期待結果:**

- [ ] フォルダのチェックボックスがindeterminate状態（横線表示）になる
- [ ] フォルダアイコンが塗りつぶし状態になる
- [ ] 選択済みファイルのみが右パネルに表示される
- [ ] フォルダをクリックすると、配下の未選択ファイルも含めて全選択される

**スクリーンショット撮影ポイント:**

- indeterminate状態のチェックボックス（横線）
- indeterminate状態のフォルダアイコン
- 右パネルの選択ファイル一覧（一部のみ選択）

---

### テストケース 4: 全選択状態表示

**目的:** フォルダ配下の全ファイルが選択されている場合、フォルダが完全選択状態で表示されることを確認

**事前条件:**

- フォルダ配下の全ファイルが選択されていること

**実行手順:**

1. フォルダを展開
2. フォルダのチェックボックスとアイコンの状態を確認
3. 配下の全ファイルの選択状態を確認

**期待結果:**

- [ ] フォルダのチェックボックスがチェック状態（チェックマーク表示）になる
- [ ] フォルダアイコンが塗りつぶし状態になる
- [ ] 配下の全ファイルのチェックボックスがチェック状態になる
- [ ] 選択ファイル一覧に配下の全ファイルが表示される

**スクリーンショット撮影ポイント:**

- 全選択状態のチェックボックス（チェックマーク）
- 全選択状態のフォルダアイコン
- 右パネルの選択ファイル一覧（全ファイル表示）

---

### テストケース 5: 未選択状態表示

**目的:** フォルダ配下のファイルが一つも選択されていない場合、フォルダが未選択状態で表示されることを確認

**事前条件:**

- フォルダ配下の全ファイルが未選択状態であること

**実行手順:**

1. フォルダを展開
2. フォルダのチェックボックスとアイコンの状態を確認
3. 配下の全ファイルの選択状態を確認

**期待結果:**

- [ ] フォルダのチェックボックスが未チェック状態になる
- [ ] フォルダアイコンが通常状態になる
- [ ] 配下の全ファイルのチェックボックスが未チェック状態になる
- [ ] 選択ファイル一覧にフォルダ配下のファイルが表示されない

**スクリーンショット撮影ポイント:**

- 未選択状態のチェックボックス（空）
- 未選択状態のフォルダアイコン
- 右パネルの選択ファイル一覧（該当フォルダのファイルなし）

---

### テストケース 6: ネストフォルダ一括選択

**目的:** 親フォルダを選択した際、ネストされた子フォルダとその配下のファイルも全て選択されることを確認

**事前条件:**

- 3階層以上のフォルダ構造が存在すること

**実行手順:**

1. 親フォルダを展開し、配下の子フォルダも展開
2. 親フォルダのチェックボックスをクリック
3. 全ての階層のフォルダとファイルの選択状態を確認
4. 選択ファイル一覧を確認

**期待結果:**

- [ ] 親フォルダのチェックボックスがチェック状態になる
- [ ] 子フォルダのチェックボックスが全てチェック状態になる
- [ ] 孫フォルダのチェックボックスもチェック状態になる
- [ ] 全ての階層のファイルが選択される
- [ ] 選択ファイル一覧に全てのファイルが表示される

**スクリーンショット撮影ポイント:**

- 親フォルダ選択前の状態（全階層展開）
- 親フォルダ選択後の状態（全階層が選択されている）
- 右パネルの選択ファイル一覧（全階層のファイル表示）

---

### テストケース 7: 空フォルダ選択

**目的:** 空フォルダのチェックボックスをクリックしてもエラーが発生せず、適切に動作することを確認

**事前条件:**

- ファイルを含まない空フォルダが存在すること

**実行手順:**

1. 空フォルダを表示
2. 空フォルダのチェックボックスをクリック
3. 選択状態を確認
4. 再度クリックして解除状態を確認

**期待結果:**

- [ ] エラーが発生しない
- [ ] チェックボックスがチェック状態になる
- [ ] フォルダアイコンが塗りつぶし状態になる
- [ ] 選択ファイル一覧に変化がない（ファイルが存在しないため）
- [ ] 再度クリックで正常に解除される

**スクリーンショット撮影ポイント:**

- 空フォルダ選択状態（チェックボックスON、アイコン変化）
- コンソールエラーが表示されていないこと

---

### テストケース 8: キーボード操作

**目的:** キーボードのSpaceキーでフォルダの選択/解除が可能であることを確認

**事前条件:**

- フォルダが表示されていること

**実行手順:**

1. フォルダにフォーカスを当てる（Tab キーまたはクリック）
2. Spaceキーを押下
3. フォルダの選択状態を確認
4. 再度Spaceキーを押下
5. フォルダの解除状態を確認

**期待結果:**

- [ ] Spaceキーでチェックボックスのトグルが可能
- [ ] フォーカスインジケーターが表示される
- [ ] クリック操作と同じ動作（配下ファイルの一括選択/解除）が実行される
- [ ] 選択ファイル一覧が正しく更新される

**スクリーンショット撮影ポイント:**

- フォーカス状態のフォルダ
- Spaceキー押下後の選択状態
- キーボード操作での選択ファイル一覧更新

---

### テストケース 9: 個別選択との共存

**目的:** フォルダ一括選択と個別ファイル選択が正しく共存し、状態が適切に管理されることを確認

**事前条件:**

- 複数のファイルを含むフォルダが存在すること

**実行手順:**

1. フォルダを展開
2. フォルダ配下の一部ファイルを個別に選択（例: 5つ中3つ）
3. フォルダのチェックボックスをクリック（一括選択）
4. 個別ファイルのチェックボックスを1つだけ解除
5. フォルダの状態を確認

**期待結果:**

- [ ] ステップ2後: フォルダがindeterminate状態になる
- [ ] ステップ3後: フォルダが全選択状態になり、配下の全ファイルが選択される
- [ ] ステップ4後: フォルダがindeterminate状態に戻る
- [ ] 選択ファイル一覧が正しく更新される
- [ ] 選択ファイル数カウントが正確

**スクリーンショット撮影ポイント:**

- 個別選択後のindeterminate状態
- 一括選択後の全選択状態
- 一部解除後の再indeterminate状態
- 各段階での選択ファイル一覧

---

### テストケース 10: 選択状態パネル連携

**目的:** フォルダ選択操作が右パネルの「選択されたファイル」一覧と正しく連携することを確認

**事前条件:**

- フォルダとファイルが表示されていること

**実行手順:**

1. フォルダを選択（配下に5つのファイル）
2. 右パネルの選択ファイル一覧を確認
3. フォルダを解除
4. 右パネルの選択ファイル一覧を確認
5. 別のフォルダを選択（配下に3つのファイル）
6. 選択ファイル数の合計を確認

**期待結果:**

- [ ] フォルダ選択時: 右パネルに配下の全ファイルが追加される
- [ ] 選択ファイル数が正しく増加する
- [ ] フォルダ解除時: 右パネルから配下の全ファイルが削除される
- [ ] 選択ファイル数が正しく減少する
- [ ] 別フォルダ選択時: 新たにファイルが追加される
- [ ] ファイルパスが正しく表示される
- [ ] 削除ボタン（×）が各ファイルに表示される

**スクリーンショット撮影ポイント:**

- フォルダ選択後の右パネル
- フォルダ解除後の右パネル
- 複数フォルダ選択後の右パネル
- 選択ファイル数カウント表示

---

## 📊 テスト実行時の注意事項

### 1. 環境確認

- Electronウィンドウが正常に表示されること
- React Developer Toolsが利用可能であること（デバッグ用）
- ブラウザのコンソールが開けること

### 2. テストデータ準備

推奨フォルダ構造:

```
test-workspace/
├── empty-folder/              # テストケース7用
├── small-folder/              # テストケース1,2用
│   ├── file1.txt
│   └── file2.txt
├── medium-folder/             # テストケース3,4,5,9用
│   ├── file1.txt
│   ├── file2.txt
│   ├── file3.txt
│   ├── file4.txt
│   └── file5.txt
└── nested-folder/             # テストケース6用
    ├── child1/
    │   ├── file1.txt
    │   └── file2.txt
    └── child2/
        └── grandchild/
            └── file3.txt
```

### 3. スクリーンショット撮影ガイドライン

- 解像度: 最低1920x1080推奨
- フォーマット: PNG形式
- ファイル名規則: `testcase-{番号}-{状態}.png`
- 保存先: `docs/30-workflows/selectable-directory-tree/screenshots/`

### 4. 問題発生時の記録

以下の情報を記録してください:

- エラーメッセージ（コンソール、UI両方）
- 再現手順
- 期待動作との差分
- スクリーンショット
- ブラウザのDevToolsコンソール出力

---

## 🔄 テスト実行フロー

### 推奨実行順序

1. **環境確認** → 開発サーバー起動、UI表示確認
2. **基本動作確認** → テストケース1,2,4,5（基本的な選択/解除）
3. **状態管理確認** → テストケース3（indeterminate状態）
4. **複雑な操作確認** → テストケース6,9（ネスト、共存）
5. **エッジケース確認** → テストケース7（空フォルダ）
6. **操作性確認** → テストケース8（キーボード）
7. **統合確認** → テストケース10（パネル連携）

### 各テスト間の待機時間

- 状態変更後: 1秒待機（アニメーション完了確認）
- スクリーンショット撮影前: 0.5秒待機（描画完了確認）

---

## 📝 テスト結果の記録方法

テスト実行後、`task-step09-manual-test-results.md` に結果を記録してください。

- **成功**: ✅ マークを付与、スクリーンショットファイル名を記載
- **失敗**: ❌ マークを付与、問題詳細と再現手順を記載
- **部分成功**: ⚠️ マークを付与、発生条件と期待動作との差分を記載
