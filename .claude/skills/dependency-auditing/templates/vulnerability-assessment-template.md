# 脆弱性評価テンプレート

## 基本情報

| 項目         | 値                            |
| ------------ | ----------------------------- |
| 評価日       | <!-- 例: 2025-11-27 -->       |
| 評価者       | <!-- 例: @dep-mgr -->         |
| プロジェクト | <!-- 例: my-project -->       |
| 監査ツール   | <!-- 例: pnpm audit, Snyk --> |

## 監査サマリー

### 検出された脆弱性数

| 重大度   | 数          | 対応期限           |
| -------- | ----------- | ------------------ |
| Critical | <!-- 数 --> | 即座（24時間以内） |
| High     | <!-- 数 --> | 緊急（72時間以内） |
| Medium   | <!-- 数 --> | 計画的（1-2週間）  |
| Low      | <!-- 数 --> | 次回リリース       |

### 総合リスク評価

- [ ] 🔴 **即座の対応が必要**: Critical/Highの脆弱性が存在
- [ ] 🟡 **計画的な対応が必要**: Medium以下の脆弱性のみ
- [ ] 🟢 **問題なし**: 脆弱性は検出されませんでした

## 脆弱性詳細

### 脆弱性 #1

| 項目           | 値                                               |
| -------------- | ------------------------------------------------ |
| CVE/GHSA ID    | <!-- 例: CVE-2023-XXXXX, GHSA-xxxx-xxxx-xxxx --> |
| パッケージ名   | <!-- 例: lodash -->                              |
| 影響バージョン | <!-- 例: < 4.17.21 -->                           |
| 修正バージョン | <!-- 例: >= 4.17.21 -->                          |
| 重大度         | <!-- Critical / High / Medium / Low -->          |
| CVSSスコア     | <!-- 例: 7.5 -->                                 |

**脆弱性の説明**:

<!-- 例: プロトタイプ汚染脆弱性。攻撃者が細工した入力により、オブジェクトのプロトタイプを汚染できる。 -->

**影響**:

<!-- 例: 認証バイパス、任意コード実行の可能性 -->

**攻撃の前提条件**:

- [ ] <!-- 例: ユーザー入力がmerge関数に渡される -->
- [ ] <!-- 例: 入力のバリデーションが不十分 -->

**プロジェクトへの影響**:

- [ ] 脆弱なコードパスが実行される: <!-- はい/いいえ/不明 -->
- [ ] 攻撃の前提条件が満たされる: <!-- はい/いいえ/不明 -->
- [ ] 本番環境で影響を受ける: <!-- はい/いいえ/不明 -->

**エクスプロイト情報**:

- [ ] 公開されたエクスプロイトが存在する
- [ ] PoC（概念実証）が存在する
- [ ] 現時点では未確認

**対応方針**:

- [ ] パッケージをアップグレード
- [ ] パッチを適用
- [ ] 代替パッケージに移行
- [ ] 緩和策を適用
- [ ] リスク受容

**対応詳細**:

<!-- 具体的な対応手順を記載 -->

---

### 脆弱性 #2

<!-- 脆弱性 #1 と同じフォーマットで記載 -->

---

## 対応計画

### 即時対応（24-72時間）

| 脆弱性       | パッケージ       | 対応              | 担当者        | 期限          |
| ------------ | ---------------- | ----------------- | ------------- | ------------- |
| <!-- CVE --> | <!-- package --> | <!-- 対応内容 --> | <!-- 担当 --> | <!-- 日付 --> |

### 計画的対応（1-2週間）

| 脆弱性       | パッケージ       | 対応              | 担当者        | 期限          |
| ------------ | ---------------- | ----------------- | ------------- | ------------- |
| <!-- CVE --> | <!-- package --> | <!-- 対応内容 --> | <!-- 担当 --> | <!-- 日付 --> |

### 次回リリースで対応

| 脆弱性       | パッケージ       | 対応              | 備考          |
| ------------ | ---------------- | ----------------- | ------------- |
| <!-- CVE --> | <!-- package --> | <!-- 対応内容 --> | <!-- 備考 --> |

## リスク受容

### 一時的にリスクを受容する脆弱性

| 脆弱性       | パッケージ       | 理由          | 有効期限      | 承認者          |
| ------------ | ---------------- | ------------- | ------------- | --------------- |
| <!-- CVE --> | <!-- package --> | <!-- 理由 --> | <!-- 日付 --> | <!-- 承認者 --> |

**リスク受容の条件**:

- [ ] 攻撃の前提条件が満たされない
- [ ] 影響を受けるコードパスが実行されない
- [ ] 他の緩和策が存在する
- [ ] パッチが近日中にリリース予定

## 緩和策

### 適用済みの緩和策

| 脆弱性       | 緩和策                | 実装日        | 効果                |
| ------------ | --------------------- | ------------- | ------------------- |
| <!-- CVE --> | <!-- 緩和策の内容 --> | <!-- 日付 --> | <!-- 効果の説明 --> |

### 緩和策の例

```javascript
// 例: 入力バリデーションの追加
function sanitizeInput(input) {
  // 危険なキーを除外
  const dangerous = ["__proto__", "constructor", "prototype"];
  return Object.keys(input)
    .filter((key) => !dangerous.includes(key))
    .reduce((obj, key) => ({ ...obj, [key]: input[key] }), {});
}
```

## 検証

### 修正後の検証

- [ ] 脆弱性が解消されたことを監査で確認
- [ ] 回帰テストが通過
- [ ] E2Eテストが通過
- [ ] パフォーマンスへの影響なし
- [ ] 新たな脆弱性が導入されていない

### 監査コマンド実行結果

```
# 修正後の監査結果を貼り付け
```

## 承認

| 役割               | 承認者        | 日付          | 承認 |
| ------------------ | ------------- | ------------- | ---- |
| セキュリティリード | <!-- 名前 --> | <!-- 日付 --> | ☐    |
| 開発リード         | <!-- 名前 --> | <!-- 日付 --> | ☐    |
| 運用担当           | <!-- 名前 --> | <!-- 日付 --> | ☐    |

## 事後分析

### 根本原因

<!-- 脆弱性が混入した原因を分析 -->

### 再発防止策

1. <!-- 再発防止策1 -->
2. <!-- 再発防止策2 -->
3. <!-- 再発防止策3 -->

### プロセス改善

- [ ] 依存関係の自動監査を強化
- [ ] セキュリティレビュープロセスの見直し
- [ ] 開発者向けセキュリティトレーニング

## 関連リンク

- **NVD**: https://nvd.nist.gov/vuln/detail/CVE-XXXX-XXXXX
- **GitHub Advisory**: https://github.com/advisories/GHSA-xxxx-xxxx-xxxx
- **パッケージのCHANGELOG**: <!-- URL -->
- **内部チケット**: <!-- URL -->

## 変更履歴

| 日付          | 変更内容          | 担当者        |
| ------------- | ----------------- | ------------- |
| <!-- 日付 --> | 初版作成          | <!-- 名前 --> |
| <!-- 日付 --> | <!-- 変更内容 --> | <!-- 名前 --> |
