# CVSS重大度評価ガイド

## 概要

CVSS（Common Vulnerability Scoring System）は、脆弱性の重大度を
客観的に評価するための業界標準スコアリングシステムです。

現在の最新バージョンはCVSS v3.1で、0.0から10.0のスコアで重大度を表現します。

## CVSSスコアの構成要素

### Base Metrics（基本評価基準）

脆弱性固有の特性を評価します。

#### Attack Vector（攻撃元区分）

| 値           | 説明                         | スコア影響 |
| ------------ | ---------------------------- | ---------- |
| Network (N)  | ネットワーク経由で攻撃可能   | 最高       |
| Adjacent (A) | 隣接ネットワークから攻撃可能 | 高         |
| Local (L)    | ローカルアクセスが必要       | 中         |
| Physical (P) | 物理アクセスが必要           | 低         |

#### Attack Complexity（攻撃条件の複雑さ）

| 値       | 説明                     | スコア影響 |
| -------- | ------------------------ | ---------- |
| Low (L)  | 特別な条件なしで攻撃可能 | 高         |
| High (H) | 特定の条件が必要         | 低         |

#### Privileges Required（必要な特権レベル）

| 値       | 説明                   | スコア影響 |
| -------- | ---------------------- | ---------- |
| None (N) | 認証不要               | 最高       |
| Low (L)  | 一般ユーザー権限が必要 | 中         |
| High (H) | 管理者権限が必要       | 低         |

#### User Interaction（ユーザー関与レベル）

| 値           | 説明               | スコア影響 |
| ------------ | ------------------ | ---------- |
| None (N)     | ユーザー操作不要   | 高         |
| Required (R) | ユーザー操作が必要 | 低         |

#### Scope（スコープ）

| 値            | 説明                             | スコア影響 |
| ------------- | -------------------------------- | ---------- |
| Unchanged (U) | 影響範囲が脆弱なコンポーネント内 | 低         |
| Changed (C)   | 他のコンポーネントに影響が波及   | 高         |

#### Impact Metrics（影響度）

| 指標                | None (N) | Low (L)      | High (H)   |
| ------------------- | -------- | ------------ | ---------- |
| Confidentiality (C) | 影響なし | 部分的漏洩   | 完全漏洩   |
| Integrity (I)       | 影響なし | 部分的改ざん | 完全改ざん |
| Availability (A)    | 影響なし | 部分的停止   | 完全停止   |

## スコアと重大度の対応

| スコア範囲 | 重大度   | 対応優先度 |
| ---------- | -------- | ---------- |
| 0.0        | None     | 情報のみ   |
| 0.1 - 3.9  | Low      | 通常対応   |
| 4.0 - 6.9  | Medium   | 計画的対応 |
| 7.0 - 8.9  | High     | 緊急対応   |
| 9.0 - 10.0 | Critical | 即座に対応 |

## 代表的な脆弱性タイプとCVSSスコア例

### Critical (9.0-10.0)

**リモートコード実行（RCE）**:

```
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
スコア: 10.0
```

- ネットワーク経由（AV:N）
- 低複雑性（AC:L）
- 認証不要（PR:N）
- ユーザー操作不要（UI:N）
- 影響範囲変更（S:C）
- 機密性・完全性・可用性すべてに高影響

**SQLインジェクション（認証バイパス）**:

```
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
スコア: 9.8
```

### High (7.0-8.9)

**クロスサイトスクリプティング（XSS）反射型**:

```
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
スコア: 6.1 - 7.1（影響度により変動）
```

**サービス拒否（DoS）**:

```
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
スコア: 7.5
```

### Medium (4.0-6.9)

**情報漏洩（限定的）**:

```
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
スコア: 4.3
```

**ローカル特権エスカレーション**:

```
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
スコア: 7.8（境界値）
```

### Low (0.1-3.9)

**軽微な情報漏洩**:

```
CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N
スコア: 2.6
```

## CVSSスコアの調整要因

### 環境的要因（Environmental Metrics）

組織固有の環境を考慮したスコア調整:

**Modified Attack Vector（修正攻撃元区分）**:

- ファイアウォールで外部アクセス遮断済み → 実質AV:L相当

**Security Requirements（セキュリティ要件）**:

- 機密性要件が高いシステム → Confidentiality影響を重視
- 可用性要件が高いシステム → Availability影響を重視

### 時間的要因（Temporal Metrics）

脆弱性の状態変化を反映:

**Exploit Code Maturity（エクスプロイトコードの成熟度）**:
| 値 | 説明 | スコア影響 |
|---|------|---------|
| Not Defined (X) | 情報なし | 調整なし |
| High (H) | 実用的なエクスプロイト存在 | 上昇 |
| Functional (F) | 動作するコード存在 | やや上昇 |
| Proof-of-Concept (P) | PoC のみ | やや低下 |
| Unproven (U) | 未確認 | 低下 |

**Remediation Level（修正レベル）**:
| 値 | 説明 | スコア影響 |
|---|------|---------|
| Not Defined (X) | 情報なし | 調整なし |
| Unavailable (U) | 修正なし | 上昇 |
| Workaround (W) | 回避策のみ | やや上昇 |
| Temporary Fix (T) | 暫定修正 | やや低下 |
| Official Fix (O) | 正式修正 | 低下 |

## プロジェクト固有の評価

### ビジネス影響度の考慮

CVSSスコアに加えて、以下を評価:

**影響を受けるシステムの重要度**:
| システム種別 | 重要度倍率 |
|------------|----------|
| 決済/金融システム | x1.5 |
| 認証/認可システム | x1.4 |
| 顧客データ処理 | x1.3 |
| 内部ツール | x0.8 |
| 開発環境のみ | x0.5 |

**実際の攻撃可能性**:

- [ ] 攻撃対象がインターネットに公開されているか？
- [ ] 脆弱な機能は本番環境で有効か？
- [ ] 攻撃に必要な前提条件は現実的か？

### 優先度算出式

```
実効優先度 = CVSSスコア × ビジネス重要度 × 攻撃可能性係数

攻撃可能性係数:
- 公開エクスプロイト存在: 1.3
- PoC存在: 1.1
- 理論上のみ: 0.9
- 攻撃困難: 0.7
```

## CVSSスコア計算ツール

### オンラインカリキュレーター

- **FIRST公式**: https://www.first.org/cvss/calculator/3.1
- **NVD**: https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator

### コマンドラインツール

```bash
# cvss-calculator pnpm パッケージ
pnpm install -g cvss-calculator
cvss-calculator "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
```

## チェックリスト

### CVSSスコア評価時

- [ ] 基本評価基準（Base Metrics）を正確に判定したか？
- [ ] 時間的要因（エクスプロイト有無）を確認したか？
- [ ] 環境的要因（自組織への適用）を考慮したか？
- [ ] ビジネス影響度を加味したか？

### 重大度判定時

- [ ] CVSSスコアのみで判断していないか？
- [ ] 実際の攻撃可能性を評価したか？
- [ ] 影響を受けるシステムの重要度を考慮したか？
- [ ] 修正の緊急性を適切に判断したか？
