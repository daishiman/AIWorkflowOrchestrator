# 知識品質保証ガイド

## 概要

形式知化された知識の品質を保証することは、知識ベース全体の信頼性と実用性を維持するために不可欠です。
このガイドでは、品質評価の基準、検証プロセス、継続的改善の方法を提供します。

## 品質評価の3軸

### 軸1: 完全性 (Completeness)

**定義**: 必要な情報がすべて含まれているか

**評価基準**:

**レベル1: 基本情報 (0-3点)**

- [ ] タイトルと概要がある
- [ ] 主要な概念が説明されている
- [ ] 最低限の使用方法が記載されている

**レベル2: 標準情報 (4-6点)**

- [ ] 前提条件が明示されている
- [ ] ワークフローが段階的に記述されている
- [ ] ベストプラクティスが含まれている
- [ ] 基本的な例がある

**レベル3: 包括的情報 (7-10点)**

- [ ] すべての必須セクションが含まれている
- [ ] エッジケースへの対応が記載されている
- [ ] トラブルシューティングが充実している
- [ ] 複数の例（基本、応用、特殊ケース）がある
- [ ] 関連知識への参照が明確である

**チェックリスト**:

```markdown
## 完全性チェック

### 必須セクション

- [ ] 概要
- [ ] いつ使うか
- [ ] 前提条件
- [ ] ワークフロー/手順
- [ ] ベストプラクティス
- [ ] トラブルシューティング
- [ ] 例
- [ ] 関連知識
- [ ] 変更履歴

### 内容の深さ

- [ ] 各セクションが2段落以上
- [ ] ワークフローが3段階以上
- [ ] 例が2つ以上
- [ ] トラブルシューティングが3項目以上
```

---

### 軸2: 明確性 (Clarity)

**定義**: 理解しやすく、曖昧さがないか

**評価基準**:

**レベル1: 基本的可読性 (0-3点)**

- [ ] 文章が文法的に正しい
- [ ] 専門用語が使われている（説明なし）
- [ ] 構造がある程度論理的

**レベル2: 標準的明確性 (4-6点)**

- [ ] 専門用語に簡単な説明がある
- [ ] 段落構成が論理的
- [ ] 見出しが適切に使われている
- [ ] 例が理解を助けている

**レベル3: 高い明確性 (7-10点)**

- [ ] 専門用語が初出時に明確に定義されている
- [ ] 段落間の論理的つながりが明確
- [ ] 判断基準がチェックリスト形式
- [ ] 例が段階的（基本→応用）
- [ ] 視覚的補助（図、表）がある

**明確性を高める技法**:

**技法1: 能動態の使用**

```
❌ 曖昧: "テストが実行される"
✅ 明確: "エージェントがテストを実行する"
```

**技法2: 具体的な数値**

```
❌ 曖昧: "適切な頻度で更新する"
✅ 明確: "6ヶ月ごとに更新する"
```

**技法3: チェックリスト化**

```
❌ 曖昧: "品質が高いこと"
✅ 明確:
- [ ] 完全性スコアが8点以上
- [ ] 明確性スコアが8点以上
- [ ] 再現性スコアが8点以上
```

**技法4: 例による説明**

```
原則: 単一責任原則

例あり:
「1つのクラスは1つの変更理由のみを持つべきです。
例: UserRepositoryクラスは、ユーザーデータのCRUD操作のみを担当し、
ユーザー認証やメール送信は別のクラスに委譲します。」

例なし:
「1つのクラスは1つの変更理由のみを持つべきです。」
```

---

### 軸3: 再現性 (Reproducibility)

**定義**: 他者が同じ結果を得られるか

**評価基準**:

**レベル1: 基本的再現性 (0-3点)**

- [ ] 手順が記述されている（ただし曖昧）
- [ ] 期待される結果が記載されている
- [ ] 前提条件が部分的に明示されている

**レベル2: 標準的再現性 (4-6点)**

- [ ] 手順が段階的に記述されている
- [ ] 各ステップの期待結果が明確
- [ ] 前提条件がすべて明示されている
- [ ] 判断基準が含まれている

**レベル3: 高い再現性 (7-10点)**

- [ ] 手順が検証可能なステップで記述されている
- [ ] 各ステップに判断基準（チェックリスト）がある
- [ ] 成功/失敗の基準が明確
- [ ] エッジケースへの対応が記載されている
- [ ] トラブルシューティングが充実している

**再現性を高める要素**:

**要素1: 前提条件の明示**

```markdown
## 前提条件

### 必要な知識

- [ ] TypeScript基本文法の理解
- [ ] React Hooksの基本概念

### 必要なツール

- Node.js 18以上
- pnpm 8以上

### 環境要件

- `.claude/skills/`ディレクトリが存在する
- プロジェクトのpackage.jsonが設定済み
```

**要素2: 検証可能なステップ**

```markdown
### ステップ1: 環境確認

**実行**:
\`\`\`bash
node --version # 18.0.0以上であることを確認
pnpm --version # 8.0.0以上であることを確認
\`\`\`

**判断基準**:

- [ ] Node.jsバージョンが18.0.0以上
- [ ] pnpmバージョンが8.0.0以上

**期待される出力**:
\`\`\`
v18.17.0
8.6.12
\`\`\`
```

**要素3: エラーハンドリング**

```markdown
### よくあるエラー1: バージョン不一致

**症状**: `Error: Unsupported engine`

**原因**: Node.jsのバージョンが古い

**解決策**:

1. Node.jsを18以上にアップデート
2. `nvm use 18`でバージョン切り替え
3. 再度コマンド実行

**予防策**: `.nvmrc`ファイルでバージョン固定
```

---

## 総合品質スコア

### 計算方法

```
総合品質スコア = (完全性 × 0.4) + (明確性 × 0.3) + (再現性 × 0.3)

各軸: 0-10点
総合: 0-10点
```

### 評価基準

**優秀 (9-10点)**:

- すぐに実践可能
- 追加情報不要
- 高い信頼性

**良好 (7-8点)**:

- 概ね実践可能
- 軽微な補足が有益
- 十分な信頼性

**要改善 (5-6点)**:

- 実践に一部不明点あり
- 重要な補足が必要
- 信頼性に懸念

**不合格 (0-4点)**:

- 実践が困難
- 大幅な改訂が必要
- 信頼性が低い

---

## 品質検証プロセス

### Phase 1: 自己評価

**実施者**: 知識作成者（エージェントまたは人間）

**手順**:

1. **完全性チェック**:
   - 必須セクションの存在確認
   - 各セクションの内容充足確認

2. **明確性チェック**:
   - 専門用語の定義確認
   - チェックリストの適切性確認
   - 例の有効性確認

3. **再現性チェック**:
   - 手順の検証可能性確認
   - 前提条件の完全性確認
   - エラーハンドリングの充実度確認

4. **スコアリング**:
   - 各軸のスコア算出
   - 総合スコア計算
   - 改善点の特定

**ツール**: `scripts/validate-knowledge.sh`

---

### Phase 2: ピアレビュー

**実施者**: 関連エージェントまたはチームメンバー

**レビュー観点**:

**観点1: 技術的正確性**

- [ ] 事実に基づいているか？
- [ ] 他の信頼できる情報源と一致するか？
- [ ] 最新のベストプラクティスに準拠しているか？

**観点2: 実用性**

- [ ] 実際のタスクで使えるか？
- [ ] 判断基準が実践的か？
- [ ] 例が現実的か？

**観点3: 整合性**

- [ ] プロジェクトの方針と一致するか？
- [ ] 他の知識と矛盾していないか？
- [ ] 用語の使い方が統一されているか？

**レビューフォーマット**:

```markdown
## ピアレビュー: [知識タイトル]

### 肯定的な点

- [良い点1]
- [良い点2]

### 改善提案

1. **[改善点1]**:
   - 現状: [問題の説明]
   - 提案: [改善案]
   - 理由: [なぜ改善が必要か]

2. **[改善点2]**:
   - ...

### 総合評価

- 完全性: [0-10点]
- 明確性: [0-10点]
- 再現性: [0-10点]
- 総合: [0-10点]

### 判定

- [ ] 承認（そのまま使用可能）
- [ ] 条件付き承認（軽微な修正後に使用可能）
- [ ] 要修正（大幅な改訂が必要）
```

---

### Phase 3: 実践検証

**実施者**: 知識を実際に使用するエージェント

**検証方法**:

1. **手順の実行**: 記載された手順を実際に実行
2. **結果の確認**: 期待される結果が得られるか
3. **問題の記録**: つまずいた点、不明点を記録
4. **フィードバック**: 改善提案を提出

**フィードバックフォーマット**:

```markdown
## 実践フィードバック: [知識タイトル]

### 実行環境

- 日時: YYYY-MM-DD
- エージェント: @[agent-name]
- タスク: [実行したタスク]

### 実行結果

- [ ] 成功
- [ ] 一部成功（以下の問題あり）
- [ ] 失敗

### 発生した問題

1. **[問題1]**:
   - ステップ: [どのステップで]
   - 症状: [何が起こったか]
   - 期待: [何を期待していたか]
   - 回避策: [どう対処したか]

### 改善提案

- [提案1]
- [提案2]

### 全体評価

- 役立ち度: [1-10点]
- 使いやすさ: [1-10点]
```

---

## 継続的品質改善

### 改善サイクル

```
作成 → 自己評価 → ピアレビュー → 実践検証
  ↑                                    ↓
  └────────── フィードバック ←──────────┘
```

### 改善トリガー

**トリガー1: スコアが基準未満**

- 総合スコア < 8点 → 即座に改善

**トリガー2: 実践での問題**

- 実行失敗が報告された → 優先的に改善

**トリガー3: フィードバックの蓄積**

- 同様の改善提案が3件以上 → 改善を検討

### 改善プロセス

**ステップ1: 問題の分析**

```
問題の性質:
- [ ] 情報不足（完全性の問題）
- [ ] 説明不足（明確性の問題）
- [ ] 手順不足（再現性の問題）
```

**ステップ2: 改善計画**

```
改善内容:
- [改善項目1]: [具体的な追加・修正内容]
- [改善項目2]: ...

影響範囲:
- [ ] SKILL.md本文
- [ ] リソースファイル
- [ ] 例
- [ ] チェックリスト

バージョニング:
- 現在: X.Y.Z
- 改善後: X'.Y'.Z'
- 理由: [major/minor/patchの判断理由]
```

**ステップ3: 改善の実施**

1. 変更を実施
2. 再評価（自己評価）
3. 変更履歴の記録
4. ピアレビュー依頼

**ステップ4: 検証**

1. 実践での再検証
2. フィードバック収集
3. 改善効果の測定

---

## 品質メトリクスの追跡

### 個別知識のメトリクス

```markdown
## 品質メトリクス: [知識タイトル]

### スコア履歴

| 日付       | 完全性 | 明確性 | 再現性 | 総合 | 備考                       |
| ---------- | ------ | ------ | ------ | ---- | -------------------------- |
| 2025-11-23 | 9      | 8      | 9      | 8.7  | 初版評価                   |
| 2025-12-10 | 10     | 9      | 9      | 9.4  | トラブルシューティング追加 |

### フィードバックサマリー

- 肯定的: 15件
- 改善提案: 3件
- 問題報告: 1件

### 使用統計

- 総参照回数: 42回
- 実行成功率: 95%
- 平均評価: 9.2/10
```

### 知識ベース全体のメトリクス

```markdown
## 知識ベース品質レポート

### 総合統計

- 総知識数: 150
- 平均品質スコア: 8.5/10
- 優秀（9-10点）: 45% (68件)
- 良好（7-8点）: 40% (60件)
- 要改善（5-6点）: 10% (15件)
- 不合格（0-4点）: 5% (7件)

### 改善アクション

- 即座に改善: 7件（不合格）
- 今月中に改善: 15件（要改善）
- 継続監視: 60件（良好）
```

---

## ベストプラクティス

### 作成時

1. **テンプレートを使用**: `templates/knowledge-document-template.md`
2. **自己評価を実施**: チェックリストで確認
3. **例を充実**: 最低2つ、できれば3つ

### レビュー時

1. **建設的フィードバック**: 問題だけでなく解決策も提示
2. **優先順位付け**: 重大な問題から指摘
3. **肯定的な点も記載**: 良い点を認識する

### 改善時

1. **小さく頻繁に**: 大きな変更を溜め込まない
2. **検証を徹底**: 改善後に必ず再検証
3. **フィードバックループ**: 改善効果を測定

---

## ツール

**検証スクリプト**: `scripts/validate-knowledge.sh` - 必須セクション、ファイルサイズ、陳腐化を自動チェック

**使用**: `./scripts/validate-knowledge.sh .claude/skills/*/SKILL.md`

---

## 参考文献

- **『Clean Code』** Robert C. Martin著 - コード品質の判断基準
- **『The Pragmatic Programmer』** Andrew Hunt, David Thomas著 - 検証の重要性
