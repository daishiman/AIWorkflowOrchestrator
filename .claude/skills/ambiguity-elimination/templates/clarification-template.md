# 曖昧性明確化テンプレート

## 概要

このテンプレートは、曖昧な要件をステークホルダーと共に明確化するための構造化された質問とドキュメント形式を提供します。

## 使用方法

1. 曖昧な要件を特定
2. 該当するパターンのセクションを選択
3. 質問リストを使用してステークホルダーにヒアリング
4. 回答を基に「明確化後の要件」を記述

---

## パターン1: 量的曖昧性の明確化

### 曖昧な要件

```markdown
元の要件:
「[曖昧な要件をここに記述]」

例: 「APIは高速に応答する」
```

### 明確化のための質問

#### 時間に関する質問
- Q1: 「高速」「速い」とは具体的に何ミリ秒/秒ですか？
- Q2: すべてのエンドポイントで同じ基準ですか？それとも個別に設定しますか？
- Q3: 平均値ですか？それとも95パーセンタイル、99パーセンタイルですか？
- Q4: 測定はサーバー側で行いますか？クライアント側ですか？
- Q5: レスポンスタイムが基準を超えた場合、どのような対応が必要ですか？

#### 量・規模に関する質問
- Q1: 「大量」「多い」とは具体的に何件/何レコード/何ユーザーですか？
- Q2: 通常時とピーク時で異なりますか？
- Q3: 将来的にどの程度まで増加する見込みですか？（1年後、3年後）
- Q4: 上限はありますか？上限を超えた場合の動作は？
- Q5: 測定方法と監視方法は？

#### 頻度に関する質問
- Q1: 「頻繁に」「定期的に」とは、何秒/分/時間/日ごとですか？
- Q2: 実行タイミングは固定ですか？それともイベントドリブンですか？
- Q3: 失敗した場合のリトライポリシーは？
- Q4: 実行履歴のログは必要ですか？
- Q5: スキップ可能な条件はありますか？

### 回答の記録

```markdown
## 質問への回答

**Q1**: [回答]
**Q2**: [回答]
**Q3**: [回答]
**Q4**: [回答]
**Q5**: [回答]

## 追加の情報

- [ステークホルダーからの補足情報]
- [制約条件]
- [優先順位]
```

### 明確化後の要件

```markdown
## [要件ID]: [要件名]

### パフォーマンス要件

**応答時間**:
- [エンドポイント名]: 平均 [X]ms、95パーセンタイルで [Y]ms、99パーセンタイルで [Z]ms
- [エンドポイント名]: 平均 [X]ms、95パーセンタイルで [Y]ms、99パーセンタイルで [Z]ms

**スループット**:
- 通常時: [X] req/sec
- ピーク時: [Y] req/sec（[期間]間継続可能）

**同時接続**:
- [接続種別]: [X] 同時接続をサポート

**測定方法**:
- ツール: [監視ツール名]
- 測定ポイント: [サーバー側/クライアント側]
- アラート条件: [基準を超えた場合の通知方法]

**基準超過時の対応**:
- [対応方法1]
- [対応方法2]
```

---

## パターン2: 質的曖昧性の明確化

### 曖昧な要件

```markdown
元の要件:
「[曖昧な要件をここに記述]」

例: 「UIは使いやすくなければならない」
```

### 明確化のための質問

#### ユーザビリティに関する質問
- Q1: 「使いやすい」を何で測定しますか？（タスク完了時間、クリック数、学習時間等）
- Q2: 新規ユーザーが基本操作を習得するまでの目標時間は？
- Q3: チュートリアルやヘルプなしで何%のユーザーが操作を完了すべきですか？
- Q4: 頻繁に使う操作は何クリック以内で完了すべきですか？
- Q5: ユーザビリティテストの計画は？（被験者数、タスク設計）

#### 信頼性・安定性に関する質問
- Q1: 「安定」「信頼性が高い」とは、稼働率何%ですか？
- Q2: 許容されるダウンタイムは月/年でどの程度ですか？
- Q3: MTBF（平均故障間隔）の目標値は？
- Q4: MTTR（平均復旧時間）の目標値は？
- Q5: 計画停止のルールは？（頻度、時間帯、事前通知期間）

#### 柔軟性・拡張性に関する質問
- Q1: 「柔軟」「拡張可能」とは、具体的にどのような変更を想定していますか？
- Q2: 設定変更可能な項目をすべて列挙してください。
- Q3: 変更はどのように行いますか？（UI、設定ファイル、API等）
- Q4: 変更の反映はリアルタイムですか？それとも再起動が必要ですか？
- Q5: 変更権限は誰が持ちますか？（ロール別）

### 回答の記録

```markdown
## 質問への回答

**Q1**: [回答]
**Q2**: [回答]
**Q3**: [回答]
**Q4**: [回答]
**Q5**: [回答]

## ユーザビリティテスト計画

- 被験者数: [X]名
- タスク: [タスク1]、[タスク2]、[タスク3]
- 成功基準: [基準]
- 測定項目: [タスク完了時間、エラー率、満足度スコア等]
```

### 明確化後の要件

```markdown
## [要件ID]: [要件名]

### ユーザビリティ要件

**学習容易性**:
- 新規ユーザーが [X]分以内に基本操作（[操作1]、[操作2]）を習得
- チュートリアルなしで [Y]%のユーザーが基本タスクを完了

**効率性**:
- 頻繁に使う操作（[操作A]、[操作B]）は [X]クリック以内
- 主要タスク（[タスク名]）を [X]分以内に完了

**エラー回復**:
- すべてのフォームに「やり直し」ボタンを配置
- データ削除前に確認ダイアログを表示
- エラーメッセージに具体的な解決手順を含む

**アクセシビリティ**:
- WCAG 2.1 レベル [AA/AAA] 準拠
- キーボードのみで全操作が可能
- スクリーンリーダー対応（ARIA属性）

**測定方法**:
- ユーザビリティテスト（被験者 [X]名以上）
- タスク完了時間とエラー率を計測
- SUS（System Usability Scale）スコア [X]点以上を目標
```

---

## パターン3: 範囲の曖昧性の明確化

### 曖昧な要件

```markdown
元の要件:
「[曖昧な要件をここに記述]」

例: 「画像ファイルなどをアップロード可能」
```

### 明確化のための質問

#### 「など」「等」の明確化
- Q1: 「など」には具体的に何が含まれますか？すべて列挙してください。
- Q2: サポートしないものは何ですか？
- Q3: 将来的に追加予定のものはありますか？
- Q4: 各項目に制約（サイズ、数量等）はありますか？
- Q5: 優先順位はありますか？（必須サポート/オプション）

#### 「主な」「代表的な」の明確化
- Q1: 「主な」ものをすべて列挙してください。
- Q2: 「主でない」ものは何ですか？それらのサポートは不要ですか？
- Q3: 優先順位の基準は何ですか？（利用頻度、重要度等）
- Q4: 必須サポート、基本サポート、非サポートに分類してください。
- Q5: 各分類での機能制限の有無は？

### 回答の記録

```markdown
## 質問への回答

**Q1**: [回答]
**Q2**: [回答]
**Q3**: [回答]
**Q4**: [回答]
**Q5**: [回答]

## サポート項目の分類

### 必須サポート（フル機能）
- [項目1]: [制約]
- [項目2]: [制約]

### 基本サポート（機能制限あり）
- [項目1]: [制約と制限内容]
- [項目2]: [制約と制限内容]

### 非サポート
- [項目1]: [非サポートの理由]
- [項目2]: [非サポートの理由]

### 将来的なサポート候補
- [項目1]: [追加予定時期]
```

### 明確化後の要件

```markdown
## [要件ID]: [要件名]

### サポート項目

**必須サポート（フル機能）**:
- [項目1]: [詳細な仕様、制約]
- [項目2]: [詳細な仕様、制約]
- [項目3]: [詳細な仕様、制約]

**基本サポート（機能制限あり）**:
- [項目1]: [詳細な仕様、制約、制限内容]
- [項目2]: [詳細な仕様、制約、制限内容]
  ※制限: [具体的な制限内容]

**非サポート**:
- [項目1]: [非サポートの理由]
- [項目2]: [非サポートの理由]
  ※非サポート時の対応: [エラーメッセージ、代替手段等]

**制約**:
- 最大[種別]数: [X]個
- 最大サイズ: [Y] MB/GB
- 同時処理: 最大[Z]個
```

---

## パターン4: 条件の曖昧性の明確化

### 曖昧な要件

```markdown
元の要件:
「[曖昧な要件をここに記述]」

例: 「必要に応じてログを出力する」
```

### 明確化のための質問

#### 条件の明確化
- Q1: 「必要に応じて」「場合によって」とは、具体的にどのような条件ですか？
- Q2: すべての条件を列挙できますか？
- Q3: 条件の優先順位は？（複数条件が同時に満たされる場合）
- Q4: 条件が満たされない場合のデフォルト動作は？
- Q5: 条件を無視して強制実行/スキップする方法はありますか？

#### 動作の明確化
- Q1: 条件が満たされた場合、何が実行されますか？
- Q2: 実行の主体は誰/何ですか？（ユーザー、システム、バッチ等）
- Q3: 実行タイミングは即座ですか？それとも遅延がありますか？
- Q4: 失敗した場合のリトライポリシーは？
- Q5: 実行結果の記録は必要ですか？

### 回答の記録

```markdown
## 質問への回答

**Q1**: [回答]
**Q2**: [回答]
**Q3**: [回答]
**Q4**: [回答]
**Q5**: [回答]

## 条件の詳細

### 条件リスト（優先順位順）
1. [条件1]: [詳細]
2. [条件2]: [詳細]
3. [条件3]: [詳細]

### 複数条件の組み合わせ
- [条件1] AND [条件2] の場合: [動作]
- [条件1] OR [条件2] の場合: [動作]
```

### 明確化後の要件

```markdown
## [要件ID]: [要件名]

### 実行条件

**条件リスト（いずれか1つでも該当した場合に実行）**:
```
条件1: [具体的な条件式]
条件2: [具体的な条件式]
条件3: [具体的な条件式]
```

**実行ロジック**:
```
IF [条件1] THEN
  [動作A]
ELSIF [条件2] THEN
  [動作B]
ELSIF [条件3] THEN
  [動作C]
ELSE
  [デフォルト動作]
END
```

**デフォルト動作（条件が満たされない場合）**:
- [動作の説明]

**強制実行/スキップ**:
- 強制実行: [方法]
- スキップ: [方法]

**実行主体とタイミング**:
- 主体: [ユーザー/システム/バッチ等]
- タイミング: [即座/遅延/スケジュール]

**エラー処理**:
- リトライポリシー: [最大回数、間隔]
- 失敗時の通知: [通知方法、通知先]

**ログと監視**:
- 記録内容: [実行日時、条件、結果等]
- 保存期間: [X]日/月/年
```

---

## パターン5: 主体の曖昧性の明確化

### 曖昧な要件

```markdown
元の要件:
「[曖昧な要件をここに記述]」

例: 「ユーザーはデータを削除できる」
```

### 明確化のための質問

#### 主体の特定
- Q1: 「ユーザー」とは、具体的にどのロールのユーザーですか？
- Q2: ロールごとに権限が異なりますか？
- Q3: 「システム」とは、具体的にどのコンポーネント/サービスですか？
- Q4: 「自動的に」のトリガーは何ですか？（イベント、スケジュール等）
- Q5: 実行の責任者は誰ですか？（承認、監査の観点）

#### 権限と責任範囲
- Q1: 各ロールの権限範囲をすべて列挙してください。
- Q2: 権限の制約は何ですか？（時間、対象範囲等）
- Q3: 権限チェックはどのように行いますか？（UI、API等）
- Q4: 権限がない場合のエラーメッセージは？
- Q5: 監査ログの記録項目は？（誰が、いつ、何を）

### 回答の記録

```markdown
## 質問への回答

**Q1**: [回答]
**Q2**: [回答]
**Q3**: [回答]
**Q4**: [回答]
**Q5**: [回答]

## ロール別の権限

### ロール1: [ロール名]
- 権限: [権限の説明]
- 制約: [制約の説明]
- 実行方法: [UI/API/バッチ等]

### ロール2: [ロール名]
- 権限: [権限の説明]
- 制約: [制約の説明]
- 実行方法: [UI/API/バッチ等]
```

### 明確化後の要件

```markdown
## [要件ID]: [要件名]

### ロール別の権限

**[ロール1]**:
- 権限範囲: [具体的な権限の説明]
- 制約: [時間制約、対象範囲等]
- 実行方法: [UI画面、APIエンドポイント等]
- 認証要件: [パスワード再確認、2段階認証等]

**[ロール2]**:
- 権限範囲: [具体的な権限の説明]
- 制約: [時間制約、対象範囲等]
- 実行方法: [UI画面、APIエンドポイント等]
- 認証要件: [パスワード再確認、2段階認証等]

### 自動実行の場合

**トリガー**:
- [トリガーの種類]: [具体的な条件]
- [スケジュール]: [cron式、頻度等]

**実行主体**:
- [コンポーネント/サービス名]: [詳細]

**処理フロー**:
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

**エラー処理**:
- 失敗時の通知: [通知先、通知方法]
- リトライポリシー: [最大回数、間隔]

### 監査ログ

**記録項目**:
- 誰が: [ユーザーID、ロール、IPアドレス]
- いつ: [タイムスタンプ（UTC）]
- 何を: [対象リソース、操作内容]
- 結果: [成功/失敗、エラーメッセージ]

**保存先**: [監査ログテーブル、ログファイル等]
**保存期間**: [X]日/月/年
**閲覧権限**: [ロール]
```

---

## 完了チェックリスト

明確化作業完了前に以下を確認:

```markdown
## 明確化完了チェックリスト

### 量的曖昧性
- [ ] すべての時間表現が具体的な数値（ms、s等）に変換されている
- [ ] すべての量表現が具体的な数値（件、レコード数等）に変換されている
- [ ] パーセンタイル、分布が明示されている
- [ ] 測定方法が記述されている

### 質的曖昧性
- [ ] ユーザビリティ表現がユーザー行動、タスク完了時間で定義されている
- [ ] 信頼性表現が稼働率、MTBF、MTTRで定量化されている
- [ ] 柔軟性表現が具体的なシナリオ、変更可能項目で記述されている
- [ ] 測定可能な指標が定義されている

### 範囲の曖昧性
- [ ] 「など」「等」が完全に列挙されている
- [ ] サポート/非サポートが明確に分離されている
- [ ] 上限、制約が明示されている
- [ ] 優先順位が付けられている

### 条件の曖昧性
- [ ] すべての条件が列挙されている
- [ ] 条件が条件式（IF-THEN形式）で表現されている
- [ ] デフォルト動作が明示されている
- [ ] エラー処理、リトライが定義されている

### 主体の曖昧性
- [ ] 「ユーザー」がロール別に分類されている
- [ ] 「システム」が具体的なコンポーネント、サービスに特定されている
- [ ] 「自動的に」のトリガーが明示されている
- [ ] 権限レベル、責任範囲が明確化されている

### 5W1H
- [ ] Who（誰が）が明確である
- [ ] What（何を）が明確である
- [ ] When（いつ）が明確である
- [ ] Where（どこで）が明確である
- [ ] Why（なぜ）が明確である
- [ ] How（どのように）が明確である

### テスト可能性
- [ ] Given-When-Then形式の受け入れ基準に変換可能である
- [ ] 境界値テストケースが作成可能である
- [ ] 測定可能な成功基準が定義されている

### ステークホルダー合意
- [ ] すべての質問に回答が得られている
- [ ] 明確化後の要件をステークホルダーがレビューしている
- [ ] ステークホルダーが承認している
```

---

## 使用例

### 使用例1: パフォーマンス要件の明確化

**元の要件**:
「システムは高速に応答する」

**明確化後**:
```markdown
## NFR-001: API応答時間要件

### パフォーマンス要件

**応答時間**:
- GET /api/users: 平均100ms、95パーセンタイルで200ms
- POST /api/orders: 平均300ms、95パーセンタイルで500ms
- GET /api/reports: 平均2s、95パーセンタイルで3s

**測定方法**:
- ツール: New Relic APM
- 測定ポイント: サーバー側（アプリケーションレベル）
- アラート条件: 95パーセンタイルが基準の120%を超えた場合、Slackに通知

**基準超過時の対応**:
- 負荷分散の調整
- データベースクエリの最適化
- キャッシュ戦略の見直し
```

### 使用例2: 設定変更権限の明確化

**元の要件**:
「管理者は設定を変更できる」

**明確化後**:
```markdown
## FR-010: 設定変更権限

### ロール別の権限

**システム管理者（最高権限）**:
- 権限範囲: すべてのシステム設定（データベース接続、APIキー、ユーザーロール定義）
- 制約: なし
- 実行方法: 管理画面の「システム設定」メニュー
- 認証要件: 変更前に2段階認証を要求

**組織管理者（組織内のみ）**:
- 権限範囲: 自組織のブランディング（ロゴ、配色）、ユーザー管理（追加、削除）
- 制約: 自組織のユーザーのみ変更可能
- 実行方法: 管理画面の「組織設定」メニュー
- 認証要件: パスワード再確認

**一般ユーザー（自分のプロフィールのみ）**:
- 権限範囲: 自分のプロフィール情報（名前、メールアドレス）、パスワード
- 制約: 自分自身のみ変更可能
- 実行方法: 「プロフィール設定」画面
- 認証要件: パスワード変更時は現在のパスワードを要求

### 監査ログ

**記録項目**:
- 誰が: ユーザーID、ロール
- いつ: タイムスタンプ（UTC）
- 何を: 変更した設定項目、変更前後の値

**保存先**: 監査ログテーブル
**保存期間**: 永久保存
**閲覧権限**: システム管理者のみ
```

---

## 関連テンプレート

- **requirements-verification-checklist.md**: 明確化後の要件検証チェックリスト
- **stakeholder-interview-guide.md**: ステークホルダーインタビューガイド
- **acceptance-criteria-template.md**: 受け入れ基準テンプレート
