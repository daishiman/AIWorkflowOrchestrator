# Red Phase（レッドフェーズ）

## 概要

Redフェーズは、TDDサイクルの最初のステップです。
失敗するテストを書くことで、実装すべき仕様を明確にします。

## 目的

- 実装前に仕様を明確化する
- テストが適切な理由で失敗することを確認する
- 実装のゴールを明確にする

## 手順

### Step 1: テスト対象の決定

実装したい機能の最小単位を決定する。

**質問**:

- この機能は何をするか？
- 入力は何か？
- 期待する出力は何か？
- エッジケースは何か？

### Step 2: テストの作成

テストを書く。

**構造**（Arrange-Act-Assert）:

1. **Arrange**: テストデータの準備
2. **Act**: テスト対象の実行
3. **Assert**: 結果の検証

### Step 3: テスト実行と失敗確認

テストを実行し、失敗することを確認する。

**確認事項**:

- テストが実行されるか？
- 適切な理由で失敗しているか？
- エラーメッセージは明確か？

## 良いテストの特徴

### FIRST原則

- **Fast**: 高速に実行できる
- **Isolated**: 他のテストに依存しない
- **Repeatable**: 何度実行しても同じ結果
- **Self-Validating**: 成功/失敗が明確
- **Timely**: 実装前に書かれている

### 一つのことだけをテスト

一つのテストは一つの振る舞いだけを検証する。

**判断基準**:

- アサーションが一つか、論理的に一つのことを検証しているか？
- テスト名が一つの振る舞いを表しているか？

## 失敗の確認方法

### 正しい失敗

- 関数が存在しない（コンパイルエラー）
- 期待値と実際の値が異なる
- 例外がスローされない

### 誤った失敗

- テストコード自体にバグがある
- テストデータが不正
- 環境依存の問題

## 最初に書くべきテスト

### 正常系から始める

最も基本的な正常系のテストから始める。

**理由**:

- 実装の基本構造を決定できる
- 成功体験を得られる
- 複雑なケースの基盤になる

### 段階的に複雑にする

1. 最も単純な正常系
2. バリエーション（異なる入力）
3. エッジケース
4. エラーケース

## チェックリスト

### テスト作成前

- [ ] テスト対象の振る舞いを言語化できるか？
- [ ] 入力と期待出力が明確か？
- [ ] テスト名を決められるか？

### テスト作成後

- [ ] テストが失敗するか？
- [ ] 失敗理由が適切か？
- [ ] エラーメッセージが明確か？
- [ ] テストが一つのことだけを検証しているか？

## よくある間違い

### 複数の振る舞いをテスト

**問題**: 一つのテストで複数のことを検証

**対処**: テストを分割する

### 実装詳細をテスト

**問題**: 内部実装に依存したテスト

**対処**: 入力と出力のみをテスト

### テストを書かずに実装開始

**問題**: TDDのサイクルを破る

**対処**: 必ずテストを先に書く
