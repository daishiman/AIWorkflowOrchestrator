---
description: |
  [コマンドの説明]
  セキュリティを考慮した実装例です。

  ⚠️ このコマンドは[破壊的操作の種類]を実行します。
  実行前に必ず確認してください。
argument-hint: "[引数名]"
allowed-tools: Read, Grep
disable-model-invocation: true
---

# [コマンド名]

## ⚠️ セキュリティ警告

このコマンドは以下の操作を行います：
- [破壊的な操作1]
- [破壊的な操作2]

**実行前に必ず確認してください。**

## セキュリティ設定

### allowed-tools の制限
このコマンドでは以下のツールのみ許可しています：

```yaml
allowed-tools: Read, Grep
```

**許可されていないツール**:
- `Bash` - 任意のコマンド実行を防止
- `Write` - 意図しないファイル変更を防止
- `Edit` - 既存ファイルの変更を防止

### disable-model-invocation
```yaml
disable-model-invocation: true
```

この設定により：
- ユーザーの明示的な確認なしに実行されません
- 自動実行を防止します

## 実行フロー

### Step 1: 事前確認
以下の情報を表示して確認を求めます：

```
⚠️ 破壊的操作の確認

以下の操作を実行しようとしています：
- [操作内容1]
- [操作内容2]

影響を受けるファイル/リソース：
- [リソース1]
- [リソース2]

続行しますか？ (yes/no)
```

### Step 2: バックアップ
```
📦 バックアップを作成中...
バックアップ先: [backup-path]
```

### Step 3: 実行
ユーザーが明示的に確認した場合のみ実行：

```
✅ 確認されました。処理を開始します...
```

### Step 4: 結果報告
```
✅ 処理が完了しました

変更内容：
- [変更1]
- [変更2]

ロールバック方法：
[ロールバックの手順]
```

## セキュリティチェックリスト

### 入力検証
- [ ] すべての入力をサニタイズ
- [ ] パス traversal 攻撃を防止
- [ ] 特殊文字をエスケープ

### 権限チェック
- [ ] ファイル/ディレクトリの権限を確認
- [ ] 必要最小限の権限で実行

### 機密情報保護
- [ ] API キーを露出しない
- [ ] パスワードをログに出力しない
- [ ] .env ファイルを保護

### 破壊的操作の保護
- [ ] ユーザー確認を必須にする
- [ ] バックアップを作成する
- [ ] ロールバック方法を提供する

## リスク評価

| リスク | レベル | 軽減策 |
|--------|--------|--------|
| データ損失 | 高 | バックアップ必須 |
| 設定破損 | 中 | 検証ステップ追加 |
| 権限昇格 | 低 | 最小権限の原則 |

## ロールバック手順

### 自動ロールバック
エラー発生時は自動的にロールバックされます。

### 手動ロールバック
```
# バックアップから復元
cp [backup-path] [original-path]

# または専用コマンドを使用
/[rollback-command]
```

## 監査ログ

このコマンドの実行は以下の情報とともに記録されます：
- 実行日時
- 実行ユーザー
- 対象リソース
- 実行結果

## 関連コマンド

- `/[backup-command]` - バックアップを作成
- `/[restore-command]` - バックアップから復元
- `/[audit-command]` - 監査ログを表示
