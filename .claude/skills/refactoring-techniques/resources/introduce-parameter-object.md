# Introduce Parameter Object

## 概要

複数の関連するパラメータをオブジェクトにまとめるリファクタリング技法です。
パラメータリストを簡潔にし、関連データを一箇所に集約します。

## 適用条件

- [ ] メソッドのパラメータが4つ以上ある
- [ ] 同じパラメータ群が複数のメソッドで使用される
- [ ] パラメータ間に論理的な関連がある
- [ ] パラメータの追加が予想される

## 手順

### Step 1: パラメータグループの特定

関連するパラメータをグループ化する。

**グループ化の基準**:

- 同じ概念に属する（日付範囲：startDate, endDate）
- 一緒に使われる（座標：x, y, z）
- 同じライフサイクル（ユーザー情報：id, name, email）

### Step 2: パラメータオブジェクトの作成

グループ化したパラメータを持つ型/クラスを定義する。

**設計指針**:

- 不変（immutable）にする
- 型安全性を確保
- 適切な名前を付ける

### Step 3: メソッドシグネチャの変更

個別パラメータをオブジェクトパラメータに置換する。

### Step 4: 呼び出し元の更新

すべての呼び出し箇所を新しいシグネチャに合わせる。

### Step 5: テスト実行

振る舞いが変わっていないことを確認する。

## パターン別実装

### パターン1: 範囲オブジェクト

日付範囲、数値範囲などを表現

**構成要素**:

- start/from値
- end/to値
- contains()やoverlaps()などのメソッド

### パターン2: 設定オブジェクト

オプショナルな設定をまとめる

**構成要素**:

- デフォルト値を持つプロパティ
- ビルダーパターンとの組み合わせ

### パターン3: コンテキストオブジェクト

実行コンテキスト情報をまとめる

**構成要素**:

- リクエスト情報
- ユーザー情報
- 環境情報

## 追加の改善

### 振る舞いの移動

パラメータオブジェクトに振る舞いを追加することを検討する。

**候補**:

- バリデーション
- 派生計算
- フォーマット処理

### 不変性の確保

パラメータオブジェクトは不変にすることが推奨される。

**理由**:

- 予期しない変更を防止
- スレッドセーフ
- テストが容易

## 判断基準チェックリスト

### 適用すべきか？

- [ ] パラメータが4つ以上あるか？
- [ ] パラメータに論理的関連があるか？
- [ ] 同じ組み合わせが他でも使われるか？
- [ ] 今後パラメータが増える可能性があるか？

### オブジェクト設計

- [ ] 適切な名前が付けられているか？
- [ ] 不変性が確保されているか？
- [ ] 型安全性があるか？
- [ ] 振る舞いを追加すべきか？

## アンチパターン

### 無関係なパラメータの結合

**問題**: 論理的に関連のないパラメータをまとめる

**対処**: 概念的に一つの単位になるものだけをまとめる

### 過度に汎用的なオブジェクト

**問題**: 再利用を重視しすぎて具体性を失う

**対処**: 適切な抽象度を維持、必要なら別のオブジェクトを作成

## 関連リファクタリング

- **Preserve Whole Object**: オブジェクトから値を取り出さずオブジェクトごと渡す
- **Replace Parameter with Method Call**: パラメータを内部計算に置換
- **Remove Flag Argument**: フラグ引数を別メソッドに分割
