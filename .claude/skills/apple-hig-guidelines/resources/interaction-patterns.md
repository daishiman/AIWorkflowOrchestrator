# HIG インタラクションパターン

## ジェスチャー

### 基本ジェスチャー

| ジェスチャー     | アクション           | 用途               |
| ---------------- | -------------------- | ------------------ |
| **タップ**       | 選択、アクティベート | ボタン、リスト項目 |
| **ダブルタップ** | ズーム、選択         | 画像、テキスト選択 |
| **長押し**       | コンテキストメニュー | 追加オプション表示 |
| **ドラッグ**     | 移動、スクロール     | リスト、地図       |
| **スワイプ**     | ナビゲーション、削除 | 戻る、リスト操作   |
| **ピンチ**       | ズームイン/アウト    | 画像、地図         |
| **回転**         | 回転                 | 画像編集           |

### スワイプ方向と意味

| 方向         | 意味             | 例                          |
| ------------ | ---------------- | --------------------------- |
| **左から右** | 戻る             | ナビゲーションスタック      |
| **右から左** | アクション表示   | 削除、アーカイブ            |
| **上から下** | 更新、閉じる     | Pull to Refresh、シート閉じ |
| **下から上** | コントロール表示 | コントロールセンター        |

### スワイプアクション

```
標準リストスワイプ:
┌────────────────────────────────────────┐
│                                        │
│  [削除]  [その他]  │ リスト項目内容      │
│   赤     グレー   │                     │
│                                        │
└────────────────────────────────────────┘

- 短いスワイプ: アクションボタン表示
- 長いスワイプ: 最初のアクション実行
```

### 長押しメニュー（Context Menu）

**表示条件**:

- 長押し: 約500ms
- 3D Touch / Haptic Touch

**メニュー構造**:

```
┌─────────────────────┐
│   プレビュー画像     │
│   (オプション)       │
├─────────────────────┤
│ 📋 コピー           │
│ 📤 共有            │
│ ─────────────────  │
│ 🗑️ 削除（赤）       │
└─────────────────────┘
```

---

## フィードバック

### 触覚フィードバック（Haptics）

| タイプ            | 強度     | 用途             |
| ----------------- | -------- | ---------------- |
| **Selection**     | 軽い     | ピッカー値変更   |
| **Light Impact**  | 軽い     | 小さなUI変化     |
| **Medium Impact** | 中程度   | ボタンタップ     |
| **Heavy Impact**  | 強い     | 重要なアクション |
| **Success**       | パターン | 成功完了         |
| **Warning**       | パターン | 警告             |
| **Error**         | パターン | エラー発生       |

### タップ状態

| 状態           | 視覚変化         | デュレーション |
| -------------- | ---------------- | -------------- |
| **ホバー**     | 背景色変化       | 即時           |
| **プレス**     | 暗くなる/縮小    | 100ms          |
| **ハイライト** | 明るく           | 200ms          |
| **選択済み**   | アクセントカラー | 維持           |

### ボタン状態の視覚表現

```css
/* プライマリボタン */
.button-primary {
  background: var(--system-blue);
  transform: scale(1);
  transition: all 100ms ease-out;
}

.button-primary:hover {
  filter: brightness(1.1);
}

.button-primary:active {
  transform: scale(0.97);
  filter: brightness(0.9);
}

.button-primary:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
```

---

## ローディング＆進捗

### インジケーターの種類

| タイプ             | 用途                 | デュレーション |
| ------------------ | -------------------- | -------------- |
| **スピナー**       | 不確定な待機         | 不明           |
| **プログレスバー** | 確定した進捗         | 計測可能       |
| **スケルトン**     | コンテンツプレビュー | 初回ロード     |
| **プルダウン**     | リフレッシュ         | 手動トリガー   |

### スピナー仕様

```
サイズ:
- Small: 20pt
- Medium: 37pt (標準)
- Large: 50pt

アニメーション:
- 回転速度: 1回転/秒
- イージング: linear（等速）
```

### プログレスバー仕様

```
高さ: 4pt (iOS標準)
角丸: 2pt
色:
- 背景: セカンダリ背景色
- 進捗: System Blue（または任意のアクセント）
- 完了: System Green

アニメーション:
- 更新: 200ms ease-out
- 不確定: 左右にスライド
```

### スケルトンローディング

```
┌─────────────────────────────────────┐
│ ┌────┐  ████████████               │
│ │    │  ████████████████           │
│ │    │  ████████                   │
│ └────┘                             │
├─────────────────────────────────────┤
│ ┌────┐  ████████████               │
│ │    │  ████████████████           │
│ └────┘                             │
└─────────────────────────────────────┘

アニメーション:
- グラデーションのシマー効果
- 左から右へ移動
- デュレーション: 1.5秒
- 繰り返し: 無限
```

---

## エラーハンドリング

### エラー表示パターン

| 深刻度     | 表示方法            | 例                       |
| ---------- | ------------------- | ------------------------ |
| **情報**   | インラインバナー    | 「新機能が利用可能」     |
| **警告**   | 黄色バナー          | 「接続が不安定」         |
| **エラー** | 赤色バナー/アラート | 「保存に失敗」           |
| **致命的** | フルスクリーン      | 「ネットワーク接続なし」 |

### インラインエラー（フォーム）

```
ラベル
┌────────────────────────────────────┐
│ 入力値                             │
│                           ❌ [赤] │
└────────────────────────────────────┘
⚠️ エラーメッセージ（13pt、赤）

- ボーダー色: System Red
- エラーアイコン: トレーリング
- メッセージ: フィールド下に即時表示
```

### トーストバナー

```
┌────────────────────────────────────────┐
│ ┌────────────────────────────────────┐ │
│ │ ⚠️ メッセージテキスト    [×] または │ │
│ │                         [アクション]│ │
│ └────────────────────────────────────┘ │
│                                        │
│               コンテンツ               │
│                                        │
└────────────────────────────────────────┘

位置: 画面上部（ナビバー下）
表示時間: 4秒（自動消去）
スワイプ: 上にスワイプで即時消去
```

### エンプティステート

```
┌────────────────────────────────────────┐
│                                        │
│            🔍                          │
│         (64pt アイコン)                │
│                                        │
│       結果が見つかりません              │
│        (17pt Semibold)                 │
│                                        │
│    検索条件を変えてみてください          │
│        (15pt Regular)                  │
│                                        │
│         [アクションボタン]              │
│         (オプション)                   │
│                                        │
└────────────────────────────────────────┘
```

---

## 入力＆フォーム

### テキスト入力状態

| 状態           | ボーダー    | 背景          | ラベル                  |
| -------------- | ----------- | ------------- | ----------------------- |
| **デフォルト** | 薄いグレー  | 透明/薄い     | 上部                    |
| **フォーカス** | System Blue | 透明          | 上部（小さく）          |
| **入力済み**   | 薄いグレー  | 透明          | 上部（小さく）          |
| **エラー**     | System Red  | 薄い赤        | 上部 + エラーメッセージ |
| **無効**       | 薄いグレー  | グレー（50%） | 薄い                    |

### フローティングラベル

```
デフォルト:
┌────────────────────────────────────┐
│ プレースホルダー                    │
└────────────────────────────────────┘

フォーカス時:
  ラベル（小さく上部に移動）
┌────────────────────────────────────┐
│ |                                  │
└────────────────────────────────────┘

トランジション: 200ms ease-out
```

### ピッカー

**日付ピッカー**:

- インライン: コンパクトに埋め込み
- ホイール: 従来のスロット形式
- カレンダー: グリッド表示

**選択ピッカー**:

- セグメント: 2-5オプション
- ホイール: 多数のオプション
- メニュー: ドロップダウン形式

### キーボードタイプ

| タイプ      | 用途           | 追加機能   |
| ----------- | -------------- | ---------- |
| **Default** | 一般テキスト   | 予測変換   |
| **Email**   | メールアドレス | @、.com    |
| **URL**     | URL入力        | /、.com    |
| **Number**  | 数字のみ       | 数字キー   |
| **Phone**   | 電話番号       | +、\*、#   |
| **Decimal** | 小数点付き数字 | 小数点     |
| **Search**  | 検索クエリ     | 検索ボタン |

---

## 選択＆マルチセレクト

### 単一選択

```
○ オプション1
● オプション2（選択中）  ← チェックマーク
○ オプション3

- 選択時: 青いチェックマーク
- 触覚: Selection feedback
```

### 複数選択

```
☐ オプション1
☑ オプション2  ← 青い塗りつぶしチェック
☑ オプション3
☐ オプション4

- 編集モードで表示
- 「すべて選択」オプション提供
```

### スワイプ選択

```
長押しまたはツータップで選択モード開始
→ ドラッグで複数選択
→ ピンチで選択範囲拡大

選択中の視覚:
- 青い丸チェックボックス（リーディング）
- 背景色ハイライト
```

---

## ドラッグ＆ドロップ

### ドラッグ開始

```
長押し（500ms）
↓
アイテムが浮き上がる（scale: 1.05, shadow: 強）
↓
ドラッグ可能状態
```

### ドラッグ中

```
┌─────────────────────────────────────┐
│                                     │
│  ドラッグアイテム                    │
│  (半透明、影付き)                   │
│                                     │
│         ↓                          │
│  ┌──────────────────────────┐      │
│  │ ドロップターゲット         │      │
│  │ (ハイライト、青枠)        │      │
│  └──────────────────────────┘      │
│                                     │
└─────────────────────────────────────┘
```

### ドロップ完了

```
- アニメーション: アイテムがターゲット位置にスナップ
- 触覚: Medium Impact
- 視覚: 一時的なハイライト
```

---

## キーボードナビゲーション（macOS/iPad）

### 基本操作

| キー          | アクション                    |
| ------------- | ----------------------------- |
| **Tab**       | 次のフォーカス可能要素        |
| **Shift+Tab** | 前のフォーカス可能要素        |
| **Space**     | ボタンアクティベート          |
| **Enter**     | デフォルトアクション          |
| **Escape**    | キャンセル、閉じる            |
| **矢印キー**  | リスト/グリッドナビゲーション |

### フォーカスリング

```css
/* 標準フォーカスリング */
:focus-visible {
  outline: 3px solid var(--system-blue);
  outline-offset: 2px;
  border-radius: inherit;
}

/* ダークモード */
@media (prefers-color-scheme: dark) {
  :focus-visible {
    outline-color: #0a84ff;
  }
}
```

### アクセスキー

| キー       | アクション             |
| ---------- | ---------------------- |
| **⌘N**     | 新規                   |
| **⌘O**     | 開く                   |
| **⌘S**     | 保存                   |
| **⌘Z**     | 取り消し               |
| **⌘⇧Z**    | やり直し               |
| **⌘C/V/X** | コピー/ペースト/カット |
| **⌘A**     | すべて選択             |
| **⌘F**     | 検索                   |
| **⌘W**     | 閉じる                 |
| **⌘Q**     | 終了                   |

---

## 参考文献

- Apple Human Interface Guidelines - Inputs
- Apple Human Interface Guidelines - Menus and Actions
- Apple Human Interface Guidelines - Feedback
- WWDC 2021: Direct and reflect focus in SwiftUI
