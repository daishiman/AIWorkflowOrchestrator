# Secret棚卸しテンプレート

## プロジェクト情報

- **プロジェクト名**: _______________
- **棚卸し実施日**: _______________
- **実施者**: _______________
- **次回レビュー予定**: _______________

## Secret一覧表

| # | Secret名 | 用途 | 使用サービス | 使用環境 | 現在の保存場所 | 重要度 | スコープ | Rotation頻度 | 最終Rotation日 | 次回Rotation予定 | アクセス権限 | 備考 |
|---|---------|------|------------|---------|-------------|-------|---------|-------------|--------------|---------------|----------|-----|
| 1 | DATABASE_URL | DB接続 | All | dev/staging/prod | Railway Secrets | Critical | Environment | 30日 | 2025-10-01 | 2025-11-01 | Admin, App | Neon Plugin自動注入 |
| 2 | OPENAI_API_KEY | AI機能 | AI Service | prod | Railway Secrets | Critical | Service | 30日 | 2025-10-15 | 2025-11-15 | AI Service | 課金対象 |
| 3 | DISCORD_WEBHOOK_URL | 通知 | Notification | prod | Railway Secrets | High | Service | 90日 | 2025-09-01 | 2025-12-01 | Discord Service | CI/CD通知兼用 |
| 4 | NEXTAUTH_SECRET | 認証 | Auth | prod | Railway Secrets | Critical | Environment | 30日 | 2025-10-20 | 2025-11-20 | Auth Service | セッション暗号化 |
| 5 | LOG_LEVEL | ログ | All | all | .env.example | Low | Global | 不定期 | - | - | All | 非機密設定 |

## 分類サマリー

### 重要度別集計

| 重要度 | 件数 | 割合 |
|-------|-----|------|
| Critical | ___ | ___% |
| High | ___ | ___% |
| Medium | ___ | ___% |
| Low | ___ | ___% |
| **合計** | ___ | 100% |

### スコープ別集計

| スコープ | 件数 | 割合 |
|---------|-----|------|
| Global | ___ | ___% |
| Environment | ___ | ___% |
| Service | ___ | ___% |
| **合計** | ___ | 100% |

### 管理方式別集計

| 管理方式 | 件数 | 割合 |
|---------|-----|------|
| Railway Secrets | ___ | ___% |
| GitHub Secrets | ___ | ___% |
| .env.example | ___ | ___% |
| その他 | ___ | ___% |
| **合計** | ___ | 100% |

## リスク評価

### 高リスク項目（即時対応必要）

| Secret名 | リスク内容 | 対応期限 | 担当者 | 対応状況 |
|---------|-----------|---------|-------|---------|
| 例: API_KEY_OLD | 期限切れ、未Rotation | 1週間以内 | DevOps | 🔄 対応中 |

### 中リスク項目（短期対応必要）

| Secret名 | リスク内容 | 対応期限 | 担当者 | 対応状況 |
|---------|-----------|---------|-------|---------|

### 改善推奨項目（中期対応）

| Secret名 | 改善内容 | 対応期限 | 担当者 | 対応状況 |
|---------|---------|---------|-------|---------|

## Rotation計画

### 今月のRotation予定

| Secret名 | 予定日 | 担当者 | 手順書 | 備考 |
|---------|-------|-------|-------|-----|
| DATABASE_URL_PROD | 2025-11-01 | DevOps | `docs/rotation-procedures.md` | ダウンタイム: なし |

### 次月のRotation予定

| Secret名 | 予定日 | 担当者 | 手順書 | 備考 |
|---------|-------|-------|-------|-----|

## アクションアイテム

### 即時対応（Critical）

- [ ] _______________________________________________
- [ ] _______________________________________________

### 短期対応（1ヶ月以内）

- [ ] _______________________________________________
- [ ] _______________________________________________

### 中期対応（3ヶ月以内）

- [ ] _______________________________________________
- [ ] _______________________________________________

## レビュー記録

### 前回レビュー

- **日付**: _______________
- **主要な発見**: _______________________________________________
- **実施した対策**: _______________________________________________

### 今回レビュー

- **日付**: _______________
- **主要な発見**: _______________________________________________
- **実施した対策**: _______________________________________________
- **次回レビュー予定**: _______________

## 承認

- **レビュー実施者**: _______________ (署名: _______) 日付: _______
- **承認者（Security Admin）**: _______________ (署名: _______) 日付: _______

## 付録: 使用ガイド

### 棚卸し手順

1. **Secret検索**: コードベース全体で環境変数参照を検索
   ```bash
   grep -r "process.env" src/
   grep -r "import.meta.env" src/
   ```

2. **一覧表作成**: すべてのSecretを上記表に記入

3. **分類実施**: 各Secretを重要度・スコープ・Rotation頻度で分類

4. **リスク評価**: 高リスク項目を特定

5. **アクションプラン**: 優先順位付きで対応計画策定

6. **定期レビュー**: 3ヶ月毎に再棚卸し

### 新規Secret追加時

1. この一覧表に追加
2. 分類を決定（重要度・スコープ・Rotation頻度）
3. 適切な管理方式を選択
4. .env.exampleを更新（必要に応じて）
5. アクセス制御マトリクスを更新
6. ドキュメント更新

### Secret削除時

1. すべての参照箇所を削除
2. Railway/GitHub Secretsから削除
3. この一覧表から削除
4. .env.exampleから削除
5. アクセス制御マトリクスから削除
