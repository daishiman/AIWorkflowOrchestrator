# 暗号アルゴリズム強度ガイド

## ハッシュアルゴリズム比較

| アルゴリズム  | 出力長        | 衝突攻撃耐性 | 速度       | ステータス | 推奨用途                   |
| ------------- | ------------- | ------------ | ---------- | ---------- | -------------------------- |
| **SHA-256**   | 256ビット     | 高           | 高速       | ✅ 推奨    | データ整合性、デジタル署名 |
| **SHA-384**   | 384ビット     | 非常に高     | 中速       | ✅ 推奨    | 高セキュリティ要件         |
| **SHA-512**   | 512ビット     | 最高         | 中速       | ✅ 推奨    | 最高レベルセキュリティ     |
| **SHA-3-256** | 256ビット     | 高           | 中速       | ✅ 推奨    | SHA-2の代替（Keccak）      |
| **BLAKE2b**   | 256-512ビット | 高           | 非常に高速 | ✅ 推奨    | 高速ハッシング             |
| **SHA-1**     | 160ビット     | ❌ 低        | 高速       | ❌ 禁止    | 使用禁止（衝突攻撃）       |
| **MD5**       | 128ビット     | ❌ 極低      | 非常に高速 | ❌ 禁止    | 使用禁止                   |

---

## 対称鍵暗号化

| アルゴリズム          | 鍵長      | セキュリティ    | 速度       | ステータス |
| --------------------- | --------- | --------------- | ---------- | ---------- |
| **AES-256-GCM**       | 256ビット | 最高            | 高速       | ✅ 推奨    |
| **AES-192-GCM**       | 192ビット | 高              | 高速       | ✅ 許容    |
| **AES-128-GCM**       | 128ビット | 高              | 非常に高速 | ✅ 許容    |
| **ChaCha20-Poly1305** | 256ビット | 最高            | 非常に高速 | ✅ 推奨    |
| **AES-256-CBC**       | 256ビット | 高（+HMAC必須） | 高速       | ✅ 許容    |
| **AES-256-ECB**       | 256ビット | ❌ 低           | 高速       | ❌ 禁止    |
| **DES**               | 56ビット  | ❌ 極低         | 高速       | ❌ 禁止    |
| **3DES**              | 168ビット | ❌ 低           | 中速       | ❌ 禁止    |
| **RC4**               | 可変      | ❌ 極低         | 非常に高速 | ❌ 禁止    |

---

## 非対称鍵暗号化

| アルゴリズム  | 鍵長       | セキュリティ | 速度       | ステータス |
| ------------- | ---------- | ------------ | ---------- | ---------- |
| **RSA-4096**  | 4096ビット | 最高         | 低速       | ✅ 推奨    |
| **RSA-2048**  | 2048ビット | 高           | 中速       | ✅ 許容    |
| **ECC P-384** | 384ビット  | 非常に高     | 高速       | ✅ 推奨    |
| **ECC P-256** | 256ビット  | 高           | 非常に高速 | ✅ 許容    |
| **Ed25519**   | 256ビット  | 高           | 非常に高速 | ✅ 推奨    |
| **RSA-1024**  | 1024ビット | ❌ 低        | 高速       | ❌ 禁止    |

---

## パスワードハッシング専用

| アルゴリズム           | メモリハード | Cost調整 | ステータス | 推奨設定          |
| ---------------------- | ------------ | -------- | ---------- | ----------------- |
| **argon2id**           | ✅           | ✅       | ✅ 推奨    | m=64MB, t=3, p=4  |
| **bcrypt**             | ❌           | ✅       | ✅ 推奨    | cost=12           |
| **scrypt**             | ✅           | ✅       | ✅ 許容    | N=16384, r=8, p=1 |
| **PBKDF2-HMAC-SHA256** | ❌           | ✅       | ⚠️ 最小    | iter=100,000+     |
| **SHA-256**            | ❌           | ❌       | ❌ 禁止    | 高速すぎ          |

---

## セキュリティレベル別推奨

### 高セキュリティ（銀行、医療）

- ハッシング: SHA-512、BLAKE2b
- 対称暗号: AES-256-GCM、ChaCha20-Poly1305
- 非対称暗号: RSA-4096、ECC P-384、Ed25519
- パスワード: argon2id（m=128MB、t=4）

### 標準セキュリティ（一般Webアプリ）

- ハッシング: SHA-256
- 対称暗号: AES-256-GCM
- 非対称暗号: RSA-2048、ECC P-256
- パスワード: bcrypt（cost=12）

### モバイル/IoT（リソース制約）

- ハッシング: BLAKE2b（高速）
- 対称暗号: AES-128-GCM、ChaCha20
- 非対称暗号: Ed25519、ECC P-256
- パスワード: bcrypt（cost=10）

---

## 量子コンピュータ耐性

### 現状

現在の暗号（RSA、ECC）は量子コンピュータで破られる可能性あり。

### 移行計画

**NIST Post-Quantum Cryptography標準化** (2024年発表):

- **CRYSTALS-Kyber**: 鍵交換
- **CRYSTALS-Dilithium**: デジタル署名
- **SPHINCS+**: ステートレス署名

### 推奨アプローチ

1. **ハイブリッド暗号**: 従来暗号 + 耐量子暗号
2. **Crypto Agility**: アルゴリズム切り替え可能な設計
3. **鍵長増加**: RSA 4096ビット、ECC P-384以上

**判断基準**:

- [ ] 長期保存データは量子耐性を考慮しているか？
- [ ] アルゴリズム切り替え可能な設計か？

---

## 参考文献

- **NIST FIPS 180-4**: Secure Hash Standard（SHA-2）
- **NIST FIPS 197**: Advanced Encryption Standard（AES）
- **NIST SP 800-57**: Recommendation for Key Management
- **NIST SP 800-90A**: Random Number Generation
- **RFC 7539**: ChaCha20 and Poly1305
