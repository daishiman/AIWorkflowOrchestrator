---
name: security-scanning
description: |

  ğŸ“š ãƒªã‚½ãƒ¼ã‚¹å‚ç…§:
  ã“ã®ã‚¹ã‚­ãƒ«ã«ã¯ä»¥ä¸‹ã®ãƒªã‚½ãƒ¼ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
  å¿…è¦ã«å¿œã˜ã¦è©²å½“ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’å‚ç…§ã—ã¦ãã ã•ã„:

  - `.claude/skills/security-scanning/resources/container-scanning.md`: Container Scanningãƒªã‚½ãƒ¼ã‚¹
  - `.claude/skills/security-scanning/resources/dependency-scanning.md`: Dependency Scanningãƒªã‚½ãƒ¼ã‚¹
  - `.claude/skills/security-scanning/resources/sbom-generation.md`: Sbom Generationãƒªã‚½ãƒ¼ã‚¹
  - `.claude/skills/security-scanning/resources/secret-detection.md`: Secret Detectionãƒªã‚½ãƒ¼ã‚¹

  - `.claude/skills/security-scanning/templates/security-scan-workflow.yml`: Security Scan Workflowãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
  - `.claude/skills/security-scanning/templates/trivy-config.yaml`: Trivy Configãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

  - `.claude/skills/security-scanning/scripts/scan-dependencies.mjs`: Scan Dependenciesã‚¹ã‚¯ãƒªãƒ—ãƒˆ

version: 1.0.0
---

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³

## æ¦‚è¦

CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ±åˆã™ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã®è¨­è¨ˆã¨å®Ÿè£…ã‚’æ”¯æ´ã™ã‚‹ã‚¹ã‚­ãƒ«ã§ã™ã€‚
ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§æ¤œå‡ºã€ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³ã€SBOM ã®ç”Ÿæˆã‚’å¯¾è±¡ã¨ã—ã¾ã™ã€‚

## å¯¾è±¡èª­è€…

- DevOps ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
- CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­è¨ˆè€…

## ã‚¹ã‚­ãƒ£ãƒ³ã®ç¨®é¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¾å­˜é–¢ä¿‚ã‚¹ã‚­ãƒ£ãƒ³    ã‚³ãƒ³ãƒ†ãƒŠã‚¹ã‚­ãƒ£ãƒ³    ã‚³ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒ³    â”‚
â”‚  â”œâ”€ npm audit       â”œâ”€ Trivy           â”œâ”€ CodeQL        â”‚
â”‚  â”œâ”€ pnpm audit      â”œâ”€ Grype           â”œâ”€ Semgrep       â”‚
â”‚  â””â”€ Snyk            â””â”€ Snyk Container  â””â”€ ESLint        â”‚
â”‚                                           Security      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SBOMç”Ÿæˆ           ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡º                      â”‚
â”‚  â”œâ”€ Syft            â”œâ”€ TruffleHog                       â”‚
â”‚  â””â”€ CycloneDX       â””â”€ GitLeaks                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ãƒªã‚½ãƒ¼ã‚¹

è©³ç´°ãªã‚¬ã‚¤ãƒ‰ã¯ä»¥ä¸‹ã‚’å‚ç…§:

| ãƒªã‚½ãƒ¼ã‚¹                                             | å†…å®¹                                |
| ---------------------------------------------------- | ----------------------------------- |
| [ä¾å­˜é–¢ä¿‚ã‚¹ã‚­ãƒ£ãƒ³](resources/dependency-scanning.md) | npm/pnpm auditã€Snyk çµ±åˆ           |
| [ã‚³ãƒ³ãƒ†ãƒŠã‚¹ã‚­ãƒ£ãƒ³](resources/container-scanning.md)  | Trivyã€Grype ã«ã‚ˆã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³ |
| [SBOM ç”Ÿæˆ](resources/sbom-generation.md)            | ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢éƒ¨å“è¡¨ã®ä½œæˆ            |
| [ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡º](resources/secret-detection.md)    | ã‚³ãƒ¼ãƒ‰å†…ã®æ©Ÿå¯†æƒ…å ±æ¤œå‡º              |

## ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

| ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ                                                       | ç”¨é€”                                    |
| ------------------------------------------------------------------ | --------------------------------------- |
| [security-scan-workflow.yml](templates/security-scan-workflow.yml) | GitHub Actions ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ |
| [trivy-config.yaml](templates/trivy-config.yaml)                   | Trivy è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«                      |

## ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ                                             | æ©Ÿèƒ½                   |
| ------------------------------------------------------ | ---------------------- |
| [scan-dependencies.mjs](scripts/scan-dependencies.mjs) | ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯ |

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ä¾å­˜é–¢ä¿‚ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰

```bash
# pnpm auditï¼ˆæ¨å¥¨ï¼‰
pnpm audit

# npm audit
npm audit

# è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ
pnpm audit --json > audit-report.json
```

### 2. ã‚³ãƒ³ãƒ†ãƒŠã‚¹ã‚­ãƒ£ãƒ³ï¼ˆTrivyï¼‰

```bash
# ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³
trivy image myapp:latest

# é‡å¤§ãªè„†å¼±æ€§ã®ã¿
trivy image --severity CRITICAL,HIGH myapp:latest

# CI/CDç”¨ï¼ˆè„†å¼±æ€§ãŒã‚ã‚Œã°å¤±æ•—ï¼‰
trivy image --exit-code 1 --severity HIGH,CRITICAL myapp:latest
```

### 3. GitHub Actions çµ±åˆ

```yaml
# .github/workflows/security.yml
name: Security Scan

on:
  push:
    branches: [main]
  pull_request:
  schedule:
    - cron: "0 0 * * 1" # æ¯é€±æœˆæ›œ

jobs:
  dependency-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: pnpm/action-setup@v4
      - run: pnpm audit --audit-level=high
```

## é‡å¤§åº¦ãƒ¬ãƒ™ãƒ«

| ãƒ¬ãƒ™ãƒ«   | å¯¾å¿œ               | SLA         |
| -------- | ------------------ | ----------- |
| Critical | å³æ™‚ä¿®æ­£å¿…é ˆ       | 24 æ™‚é–“ä»¥å†… |
| High     | å„ªå…ˆä¿®æ­£           | 1 é€±é–“ä»¥å†…  |
| Medium   | è¨ˆç”»çš„ä¿®æ­£         | 1 ãƒ¶æœˆä»¥å†…  |
| Low      | æ¬¡å›ãƒªãƒªãƒ¼ã‚¹ã§æ¤œè¨ | ä»»æ„        |

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **ã‚·ãƒ•ãƒˆãƒ¬ãƒ•ãƒˆ**: é–‹ç™ºæ®µéšã§æ—©æœŸã«ã‚¹ã‚­ãƒ£ãƒ³
2. **è‡ªå‹•åŒ–**: CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ±åˆ
3. **ç¶™ç¶šçš„ç›£è¦–**: å®šæœŸã‚¹ã‚­ãƒ£ãƒ³ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
4. **SBOM ç®¡ç†**: ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢æ§‹æˆã‚’å¯è¦–åŒ–
5. **ä¾‹å¤–ç®¡ç†**: èª¤æ¤œçŸ¥ã¯ãƒãƒªã‚·ãƒ¼ã§é™¤å¤–

## é–¢é€£ã‚¹ã‚­ãƒ«

- [CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³](../ci-cd-pipelines/SKILL.md) - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã®çµ±åˆå…ˆ
- [Docker ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](../docker-best-practices/SKILL.md) - ã‚³ãƒ³ãƒ†ãƒŠã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
