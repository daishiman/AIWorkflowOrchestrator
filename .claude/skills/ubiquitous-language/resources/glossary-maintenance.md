# 用語集の維持管理

## 概要

ユビキタス言語の用語集は、作成して終わりではなく継続的に維持管理する必要があります。
このドキュメントでは、用語集を最新かつ有用な状態に保つための実践方法を解説します。

## 用語集の構成要素

### 必須項目

| 項目         | 説明                                 | 例                           |
| ------------ | ------------------------------------ | ---------------------------- |
| 用語         | ドメインで使用される言葉             | 注文                         |
| 定義         | 簡潔で明確な説明                     | 顧客が商品を購入する意思表示 |
| コンテキスト | 使用される境界付けられたコンテキスト | 販売コンテキスト             |
| コード対応   | 対応するクラス名/型名                | Order                        |

### 推奨項目

| 項目             | 説明                             | 例                       |
| ---------------- | -------------------------------- | ------------------------ |
| 関連用語         | 関連する他の用語                 | 顧客、商品、配送         |
| 同義語（非推奨） | 同じ意味で使われることがある用語 | オーダー（非推奨）       |
| 使用例           | 実際の使用文脈                   | 「顧客が注文を確定した」 |
| 変更履歴         | 定義の変更記録                   | 2024-01-15: 初版作成     |
| 担当者           | 用語の管理責任者                 | 販売チーム               |

## 用語集のフォーマット

### Markdownフォーマット（推奨）

```markdown
## 注文（Order）

**定義**: 顧客が商品を購入する意思表示。一つ以上の注文明細を含む。

**コンテキスト**: 販売

**コード対応**: `Order` クラス（src/sales/domain/Order.ts）

**関連用語**: 顧客、注文明細、配送

**状態遷移**:

- 下書き → 確定 → 承認待ち → 承認済み → 出荷済み → 配達完了
- いずれの状態からも「キャンセル」に遷移可能（出荷前のみ）

**使用例**:

- 「顧客が注文を確定した」
- 「注文が承認された」
- 「注文をキャンセルする」

**変更履歴**:
| 日付 | 変更内容 | 担当者 |
|-----|---------|--------|
| 2024-01-15 | 初版作成 | 田中 |
| 2024-03-01 | 状態遷移を追加 | 佐藤 |
```

### JSONフォーマット（自動処理用）

```json
{
  "term": "注文",
  "englishTerm": "Order",
  "definition": "顧客が商品を購入する意思表示",
  "context": "販売",
  "codeMapping": {
    "className": "Order",
    "filePath": "src/sales/domain/Order.ts"
  },
  "relatedTerms": ["顧客", "注文明細", "配送"],
  "deprecated": {
    "terms": ["オーダー"],
    "reason": "英語表記を避け、日本語「注文」に統一"
  },
  "examples": ["顧客が注文を確定した", "注文が承認された"],
  "history": [
    {
      "date": "2024-01-15",
      "change": "初版作成",
      "author": "田中"
    }
  ]
}
```

## 維持管理プロセス

### 1. 用語追加プロセス

```
1. 新しい用語の発見
   ↓
2. 提案書の作成
   - 用語名
   - 定義（案）
   - 使用コンテキスト
   - 提案理由
   ↓
3. ドメインエキスパートのレビュー
   - 定義の正確性確認
   - 既存用語との重複確認
   ↓
4. 開発チームのレビュー
   - コード対応の確認
   - 命名規則との整合性
   ↓
5. 用語集への追加
   ↓
6. チームへの周知
```

### 2. 用語変更プロセス

```
1. 変更の必要性特定
   - ビジネスの変化
   - 誤りの発見
   - より良い表現の提案
   ↓
2. 影響範囲の調査
   - コードへの影響
   - ドキュメントへの影響
   - 他チームへの影響
   ↓
3. 変更提案と承認
   ↓
4. 用語集の更新
   ↓
5. コードの更新（必要な場合）
   ↓
6. チームへの周知
```

### 3. 定期レビューサイクル

| 頻度   | 対象           | 担当                        |
| ------ | -------------- | --------------------------- |
| 週次   | 新規追加の確認 | 開発チーム                  |
| 月次   | 定義の見直し   | ドメインエキスパート + 開発 |
| 四半期 | 全体レビュー   | プロジェクト全体            |

## 用語集の配置

### 推奨構成

```
project/
├── docs/
│   └── domain/
│       ├── glossary.md           # 用語集本体
│       ├── glossary.json         # 機械可読形式
│       └── contexts/
│           ├── sales-terms.md    # 販売コンテキストの用語
│           ├── shipping-terms.md # 配送コンテキストの用語
│           └── support-terms.md  # サポートコンテキストの用語
└── src/
    └── shared/
        └── domain/
            └── glossary.ts       # 用語の型定義（オプション）
```

### アクセシビリティ

- **Wiki/Confluence**: チーム全体がアクセスしやすい場所
- **README**: プロジェクトルートから用語集へのリンク
- **コード内参照**: JSDocやコメントで用語集へのリンク

```typescript
/**
 * 注文エンティティ
 *
 * @see docs/domain/glossary.md#注文
 */
class Order {}
```

## 自動化

### 用語一貫性チェック

```javascript
// scripts/check-terminology.mjs
// コード内で使用される用語と用語集の整合性をチェック

const glossary = loadGlossary("docs/domain/glossary.json");

// クラス名が用語集に存在するか確認
// 非推奨用語が使われていないか確認
// 用語の揺れがないか確認
```

### 用語集の自動生成支援

```javascript
// コードから用語候補を抽出
// - クラス名
// - 列挙型の値
// - メソッド名の動詞

// 用語集との差分を検出
// 新しい用語候補をレポート
```

## チームコミュニケーション

### 周知方法

1. **Slack/Teams通知**: 用語追加・変更時に自動通知
2. **週次ミーティング**: 新規用語のレビュー
3. **オンボーディング**: 新メンバーへの用語集紹介
4. **PR レビュー**: 命名が用語集に従っているか確認

### 用語議論のルール

1. **オープンな議論**: 用語の定義は全員で議論
2. **ドメインエキスパート優先**: 最終判断はドメインエキスパート
3. **記録を残す**: 議論の経緯を変更履歴に記録
4. **一度決めたら遵守**: 決定後は全員が従う

## トラブルシューティング

### 問題1: 用語集が更新されない

**原因**: 更新プロセスが面倒、責任が不明確

**解決策**:

- 更新プロセスを簡素化
- 責任者を明確化
- PRレビューに用語チェックを追加
- 自動化ツールの導入

### 問題2: 用語集が参照されない

**原因**: アクセスしにくい、存在を知らない

**解決策**:

- アクセスしやすい場所に配置
- 開発環境に統合（IDE プラグイン等）
- オンボーディングで必ず紹介
- コード内からリンク

### 問題3: コードと用語集が乖離

**原因**: 同時に更新されない

**解決策**:

- 用語変更時はコード変更も同時に
- CIで用語一貫性チェック
- リファクタリングスプリントの設定

## チェックリスト

### 用語集の品質チェック

- [ ] すべての用語に明確な定義があるか？
- [ ] コード対応が記載されているか？
- [ ] コンテキストが明示されているか？
- [ ] 非推奨用語が整理されているか？
- [ ] 変更履歴が記録されているか？
- [ ] ドメインエキスパートがレビューしたか？

### 維持管理プロセスチェック

- [ ] 用語追加プロセスが定義されているか？
- [ ] 定期レビューが実施されているか？
- [ ] 責任者が明確か？
- [ ] チームに周知されているか？
- [ ] 自動チェックが導入されているか？
