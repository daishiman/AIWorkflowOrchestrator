# Semver仕様詳細

## セマンティックバージョニング 2.0.0

セマンティックバージョニング（SemVer）は、ソフトウェアのバージョン番号に意味を持たせる規約です。

## バージョン形式

```
MAJOR.MINOR.PATCH[-PRERELEASE][+BUILD]
```

### 各要素の意味

| 要素 | 説明 | 例 |
|-----|------|-----|
| MAJOR | 後方互換性のない変更 | 2.0.0 |
| MINOR | 後方互換性のある機能追加 | 1.1.0 |
| PATCH | 後方互換性のあるバグ修正 | 1.0.1 |
| PRERELEASE | プレリリースバージョン | 1.0.0-alpha |
| BUILD | ビルドメタデータ | 1.0.0+build.123 |

## バージョン増加ルール

### MAJOR（メジャー）バージョン

**増加条件**:
- APIの削除または名前変更
- 関数のシグネチャ変更（引数の追加/削除/型変更）
- デフォルト動作の変更
- 依存関係の最小バージョン引き上げ
- Node.jsなどの実行環境の最小バージョン引き上げ

**例**:
```javascript
// v1.x.x
function getUser(id) { ... }

// v2.0.0 - 破壊的変更: 引数が追加された
function getUser(id, options) { ... }
```

### MINOR（マイナー）バージョン

**増加条件**:
- 新しい機能の追加
- 新しいAPIの追加
- 既存APIの非推奨化（削除はMajor）
- パフォーマンス改善（動作変更なし）

**例**:
```javascript
// v1.0.x
class UserService {
  getUser(id) { ... }
}

// v1.1.0 - 新機能追加
class UserService {
  getUser(id) { ... }
  getUsersByRole(role) { ... }  // 新しいメソッド
}
```

### PATCH（パッチ）バージョン

**増加条件**:
- バグ修正
- セキュリティパッチ
- ドキュメントの修正
- 内部実装のリファクタリング（外部動作変更なし）

**例**:
```javascript
// v1.0.0 - バグあり
function calculateTotal(items) {
  return items.reduce((sum, item) => sum + item.price);  // 初期値なし
}

// v1.0.1 - バグ修正
function calculateTotal(items) {
  return items.reduce((sum, item) => sum + item.price, 0);  // 初期値追加
}
```

## プレリリースバージョン

### 形式

```
X.Y.Z-<identifier>[.<identifier>...]
```

### 一般的な識別子

| 識別子 | 意味 | 安定性 |
|-------|------|-------|
| alpha | 初期開発段階 | 低 |
| beta | 機能完成、テスト中 | 中 |
| rc | リリース候補 | 高 |

### 優先順位

```
1.0.0-alpha < 1.0.0-alpha.1 < 1.0.0-beta < 1.0.0-beta.2 < 1.0.0-rc.1 < 1.0.0
```

**重要**: プレリリースバージョンは通常のバージョン範囲（`^`や`~`）に含まれない

## バージョン比較ルール

### 数値比較

```
1.0.0 < 2.0.0 < 2.1.0 < 2.1.1
```

### プレリリース比較

```
1.0.0-alpha < 1.0.0-alpha.1 < 1.0.0-alpha.2 < 1.0.0-beta < 1.0.0
```

### ビルドメタデータ

ビルドメタデータはバージョン比較に影響しない:
```
1.0.0+build1 == 1.0.0+build2
```

## 0.x.x バージョンの特別ルール

バージョン0.x.xは「初期開発段階」を意味し、特別なルールが適用されます:

**特徴**:
- 0.x.xではいつでも破壊的変更が起こりうる
- `^0.2.3`は`>=0.2.3 <0.3.0`と解釈される（チルダと同等）
- 安定版（1.0.0以上）へのアップグレードは特に注意が必要

**判断基準**:
- 0.x.xパッケージは慎重に扱う
- 可能であれば1.0.0以上の安定版を選択
- 0.x.xを使う場合はバージョン範囲を狭く設定

## semver準拠の判定

パッケージがsemverに準拠しているかの判断基準:

### 準拠している兆候
- [ ] CHANGELOGに破壊的変更が明記されている
- [ ] Majorバージョン変更時に移行ガイドが提供される
- [ ] リリースノートが詳細に記載されている
- [ ] 長期間のメンテナンス実績がある

### 準拠していない兆候
- [ ] Minor/Patch更新で動作が変わった経験がある
- [ ] CHANGELOGが不完全または存在しない
- [ ] 0.x.xのまま長期間更新されている
- [ ] コミュニティでの互換性問題の報告が多い

## チェックリスト

### バージョン変更評価
- [ ] 変更タイプ（Major/Minor/Patch）を正確に分類したか？
- [ ] プレリリースバージョンの場合、特別な扱いを考慮したか？
- [ ] 0.x.xバージョンの場合、追加のリスクを認識したか？
- [ ] パッケージのsemver準拠度を評価したか？
