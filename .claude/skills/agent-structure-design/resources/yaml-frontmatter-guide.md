# YAML Frontmatter設計ガイド

## 概要

YAML Frontmatterは、エージェントのメタデータを定義する最も重要な要素です。
Claude が自動的にエージェントを選択・起動する際の判断材料となります。

## 必須フィールド

### name（必須）

**目的**: エージェントの一意な識別子

**形式**: kebab-case
**パターン**: `[domain]-[role]` または `[role]-[agent]`
**長さ**: 3-50文字

**良い例**:

- `security-auditor`
- `database-migrator`
- `api-doc-generator`
- `frontend-developer`

**悪い例**:

- `SecurityAuditor` （camelCase）
- `security_auditor` （snake_case）
- `sec-aud` （短すぎる）
- `security-vulnerability-detection-and-remediation-specialist` （長すぎる）

**命名のベストプラクティス**:

1. 役割を明確に表現
2. ドメインを含める（該当する場合）
3. 他のエージェントと区別できる
4. 発音しやすく、記憶しやすい

---

### description（必須・最重要）

**目的**: エージェントの自動起動を促すトリガー情報と概要

**重要性**: ★★★★★（最も重要）

- Claudeがエージェントを選択する主な判断材料
- トリガーキーワードが豊富であるほど発動率が高い

**構成要素**:

1. **主要機能**（1-2文）: エージェントが何をするかの簡潔な説明
2. **専門分野**（3-5項目）: 具体的な技術や機能領域
3. **使用タイミング**（3-5項目）: 「〇〇する時」という形式
4. **プロアクティブ指示**（オプション）: 英語での自動起動条件

**推奨長さ**: 4-8行

**テンプレート**:

```yaml
description: |
  [1-2文の主要機能説明]

  専門分野:
  - [分野1]: [詳細1]
  - [分野2]: [詳細2]
  - [分野3]: [詳細3]

  使用タイミング:
  - [タイミング1]
  - [タイミング2]
  - [タイミング3]

  Use proactively when [英語での条件].
```

**優れたdescriptionの例**:

```yaml
description: |
  データベーススキーマ設計とマイグレーション管理を専門とするエージェント。
  Drizzle ORMとSQLite (Turso)を使用した効率的なスキーマ設計を提供します。

  専門分野:
  - スキーマ設計: 正規化、インデックス戦略、JSON活用
  - マイグレーション: バージョン管理、ロールバック戦略、本番適用
  - パフォーマンス最適化: クエリ最適化、インデックス設計、ベクトル検索統合

  使用タイミング:
  - データベーススキーマを設計する時
  - マイグレーションファイルを作成する時
  - スキーマ変更をレビューする時
  - インデックス戦略を最適化する時

  Use proactively when designing database schemas, creating migrations,
  or optimizing database performance.
```

**チェックリスト**:

- [ ] 行動志向の動詞を使用しているか？（設計する、実装する、分析する等）
- [ ] 具体的な技術名が含まれているか？
- [ ] トリガーキーワードが5個以上あるか？
- [ ] 使用タイミングが「〇〇する時」という明確な形式か？
- [ ] プロアクティブ指示が英語で記述されているか？

---

## オプションフィールド

### tools（オプション・推奨）

**目的**: エージェントが使用可能なツールを定義

**形式**: リスト形式
**デフォルト**: 指定がない場合、制限なし（推奨されない）

**ツール選択の判断フロー**:

```
エージェントの役割は？
├─ 分析・レビュー → [Read, Grep, Glob]
├─ 実装・生成 → [Read, Write, Edit, Grep]
├─ 委譲・調整 → [Task, Read]
└─ デプロイ・管理 → [Bash, Read, Write, Edit, Task]
```

**ツールカテゴリ**:

#### 読み取り専用

```yaml
tools:
  - Read
  - Grep
  - Glob
```

**用途**: 分析、レビュー、監査エージェント
**特徴**: 副作用なし、安全性が高い

#### 実装系

```yaml
tools:
  - Read
  - Write
  - Edit
  - Grep
```

**用途**: 機能実装、ファイル生成エージェント
**特徴**: ファイル操作可能、パス制限必須

#### オーケストレーター

```yaml
tools:
  - Task
  - Read
```

**用途**: マルチエージェント調整、プロジェクト管理
**特徴**: 他エージェントへの委譲可能

#### フル権限

```yaml
tools:
  - Bash
  - Read
  - Write
  - Edit
  - Grep
  - Glob
  - Task
```

**用途**: デプロイ、マイグレーション、システム管理
**特徴**: 承認要求推奨、リスクが高い

**セキュリティ考慮事項**:

- パス制限（write_allowed_paths, write_forbidden_paths）
- 承認要求（approval_required）
- 危険なBashコマンドの制限

---

### model（オプション）

**目的**: 使用するClaudeモデルを指定

**選択肢**:

- `opus`: 高度な推論、アーキテクチャ設計、複雑な分析
- `sonnet`: 一般的な実装、バランス型（デフォルト推奨）
- `haiku`: シンプルな検証、高速処理

**選択基準**:

| モデル | タスクの複雑度 | コスト | 速度 | 推奨用途                         |
| ------ | -------------- | ------ | ---- | -------------------------------- |
| opus   | 高             | 高     | 遅   | アーキテクチャ設計、システム分析 |
| sonnet | 中             | 中     | 中   | 一般的な実装、バランス型         |
| haiku  | 低             | 低     | 速   | シンプルな検証、高速処理         |

**デフォルト**: 指定なしの場合、`sonnet`が使用される

---

### version（オプション）

**目的**: エージェントのバージョン管理

**形式**: セマンティックバージョニング（major.minor.patch）
**初版**: `1.0.0`

**更新ルール**:

- **major**: 破壊的変更（動作が大きく変わる）
- **minor**: 機能追加（後方互換性あり）
- **patch**: バグ修正（軽微な変更）

**例**:

```yaml
version: 1.2.3
# major: 1
# minor: 2
# patch: 3
```

---

## 完全な例

```yaml
---
name: database-schema-designer
description: |
  データベーススキーマ設計とマイグレーション管理を専門とするエージェント。
  Drizzle ORMとSQLite (Turso)を使用した効率的なスキーマ設計を提供します。

  専門分野:
  - スキーマ設計: 正規化、インデックス戦略、JSON活用
  - マイグレーション: バージョン管理、ロールバック戦略
  - パフォーマンス最適化: クエリ最適化、ベクトル検索統合

  使用タイミング:
  - データベーススキーマを設計する時
  - マイグレーションファイルを作成する時
  - スキーマ変更をレビューする時

  Use proactively when designing database schemas or creating migrations.
tools:
  - Read
  - Write
  - Edit
  - Grep
model: sonnet
version: 1.0.0
---
```

---

## よくある間違い

### 1. description が短すぎる

❌ **悪い例**:

```yaml
description: データベーススキーマを設計するエージェント
```

✅ **良い例**:

```yaml
description: |
  データベーススキーマ設計とマイグレーション管理を専門とするエージェント。

  専門分野:
  - スキーマ設計: 正規化、インデックス戦略

  使用タイミング:
  - データベーススキーマを設計する時
```

### 2. トリガーキーワードが不足

❌ **悪い例**:

```yaml
description: 様々なタスクを実行するエージェント
```

✅ **良い例**:

```yaml
description: |
  TypeScript、React、Next.jsを使用したフロントエンド開発
```

### 3. tools の過剰な権限

❌ **悪い例**:

```yaml
tools:
  - Bash
  - Read
  - Write
  - Edit
  - Grep
  - Glob
  - Task
```

✅ **良い例**:

```yaml
tools:
  - Read
  - Grep # 分析エージェントに必要最小限
```

---

## チェックリスト

YAML Frontmatter作成時の最終チェック:

- [ ] name は kebab-case で3-50文字
- [ ] description は4-8行で、専門分野と使用タイミングを含む
- [ ] トリガーキーワードが5個以上
- [ ] tools は役割に応じた最小権限
- [ ] model選択が適切（複雑度に応じて）
- [ ] version はセマンティックバージョニング
