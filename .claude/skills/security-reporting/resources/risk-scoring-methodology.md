# リスクスコアリング手法

## リスクスコア計算式

```
リスクスコア = CVSS × Exploitability × Scope × Context

範囲: 0.0 ~ 30.0
```

---

## 要素詳細

### CVSS (0.0 ~ 10.0)

CVE脆弱性のCVSS v3.1スコアを使用。
コード脆弱性の場合は類似CVEを参考に推定。

---

### Exploitability（悪用可能性）: 1.0 ~ 3.0

| レベル     | 倍率 | 条件                                       |
| ---------- | ---- | ------------------------------------------ |
| 極めて容易 | 3.0  | 既知のエクスプロイトツール存在、自動化可能 |
| 容易       | 2.5  | PoC公開済み、中程度のスキルで実行可能      |
| 中程度     | 2.0  | 技術的に実現可能、高度なスキル必要         |
| 困難       | 1.5  | 複数の条件が必要、専門知識必要             |
| 非常に困難 | 1.0  | 理論的のみ、実用的な攻撃は困難             |

---

### Scope（影響範囲）: 0.5 ~ 2.0

| レベル | 倍率 | 条件                               |
| ------ | ---- | ---------------------------------- |
| 広範   | 2.0  | 全ユーザー、全データ、システム全体 |
| 重要   | 1.5  | 重要データ・機能、多数のユーザー   |
| 限定的 | 1.0  | 特定条件下、一部ユーザー           |
| 最小限 | 0.5  | 極めて限定的、devDependencies      |

---

### Context（コンテキスト）: 0.5 ~ 1.5

| レベル          | 倍率 | 条件                             |
| --------------- | ---- | -------------------------------- |
| 本番環境        | 1.5  | 本番で使用中、インターネット公開 |
| ステージング    | 1.2  | ステージング環境、限定公開       |
| 開発環境        | 1.0  | 開発環境のみ                     |
| devDependencies | 0.5  | ビルド時のみ、本番に含まれない   |

---

## リスクレベル判定

| リスクスコア | レベル   | 優先度 | 期限               |
| ------------ | -------- | ------ | ------------------ |
| 27.0 ~ 30.0  | Critical | P0     | 即座（24時間以内） |
| 18.0 ~ 26.9  | Critical | P0     | 即座（48時間以内） |
| 12.0 ~ 17.9  | High     | P1     | 1週間以内          |
| 6.0 ~ 11.9   | Medium   | P2     | 1ヶ月以内          |
| 3.0 ~ 5.9    | Low      | P3     | 次回リリース       |
| 0.0 ~ 2.9    | Info     | P4     | 監視のみ           |

---

## 計算例

### 例1: 本番環境のSQLインジェクション

```
CVSS: 9.8（既知のCVE参照）
Exploitability: 3.0（自動化ツール存在）
Scope: 2.0（全ユーザー、全データ）
Context: 1.5（本番環境）

リスクスコア = 9.8 × 3.0 × 2.0 × 1.5 = 88.2
→ 30.0上限で切り捨て = 30.0
→ Critical P0（即座に修正）
```

### 例2: devDependenciesの脆弱性

```
CVSS: 7.5
Exploitability: 2.0
Scope: 0.5（devDependenciesのみ）
Context: 0.5（ビルド時のみ）

リスクスコア = 7.5 × 2.0 × 0.5 × 0.5 = 3.75
→ Low P3（次回リリースで対応）
```

---

## 参考文献

- **CVSS Calculator**: https://www.first.org/cvss/calculator/3.1
- **OWASP Risk Rating Methodology**: https://owasp.org/www-community/OWASP_Risk_Rating_Methodology
