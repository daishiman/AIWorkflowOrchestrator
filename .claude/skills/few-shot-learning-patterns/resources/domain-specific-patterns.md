# ドメイン別Few-Shotパターン

## 概要

ドメインごとに最適なFew-Shotパターンは異なります。
このガイドでは、主要なドメイン別のベストプラクティスを提供します。

## テキスト分類

### 感情分析

```markdown
# 推奨: 3-5例（各感情カテゴリに1例+境界ケース）

テキストの感情を分析してください。
出力形式: { "sentiment": "positive|negative|neutral", "confidence": 0.0-1.0 }

例1（明確にポジティブ）:
テキスト: 「この製品は本当に素晴らしい！期待以上でした。」
出力: { "sentiment": "positive", "confidence": 0.95 }

例2（明確にネガティブ）:
テキスト: 「品質がひどく、返品しました。二度と買いません。」
出力: { "sentiment": "negative", "confidence": 0.92 }

例3（中立）:
テキスト: 「商品を受け取りました。普通でした。」
出力: { "sentiment": "neutral", "confidence": 0.85 }

例4（混合・境界ケース）:
テキスト: 「デザインは良いけど、価格が高すぎる。」
出力: { "sentiment": "neutral", "confidence": 0.65 }
```

### カテゴリ分類

```markdown
# 推奨: 各カテゴリに1例（最低限）

問い合わせを適切なカテゴリに分類してください。
カテゴリ: 技術サポート、請求関連、配送関連、その他

例1:
問い合わせ: 「アプリがクラッシュして起動しません」
カテゴリ: 技術サポート

例2:
問い合わせ: 「今月の請求金額が間違っています」
カテゴリ: 請求関連

例3:
問い合わせ: 「注文した商品がまだ届きません」
カテゴリ: 配送関連

例4:
問い合わせ: 「サービス内容について質問があります」
カテゴリ: その他
```

## データ抽出

### エンティティ抽出

```markdown
# 推奨: 3-4例（異なるエンティティパターン）

テキストから人名、組織名、場所を抽出してください。

例1（すべてのエンティティ含む）:
テキスト: 「田中太郎氏はソニー株式会社の東京本社で働いています。」
抽出:
- 人名: ["田中太郎"]
- 組織名: ["ソニー株式会社"]
- 場所: ["東京"]

例2（一部のみ）:
テキスト: 「Appleは新製品を発表しました。」
抽出:
- 人名: []
- 組織名: ["Apple"]
- 場所: []

例3（複数エンティティ）:
テキスト: 「山田花子と佐藤次郎は大阪と京都を訪問した。」
抽出:
- 人名: ["山田花子", "佐藤次郎"]
- 組織名: []
- 場所: ["大阪", "京都"]
```

### 構造化データ抽出

```markdown
# 推奨: 4-5例（様々な入力形式）

製品情報を構造化データとして抽出してください。

例1（完全な情報）:
入力: 「iPhone 15 Pro - 128GB - スペースブラック - 159,800円」
出力:
{
  "product_name": "iPhone 15 Pro",
  "storage": "128GB",
  "color": "スペースブラック",
  "price": 159800
}

例2（一部欠損）:
入力: 「MacBook Air M2 - 256GB - 148,800円」
出力:
{
  "product_name": "MacBook Air M2",
  "storage": "256GB",
  "color": null,
  "price": 148800
}

例3（異なる形式）:
入力: 「Apple Watch Ultra 2（チタニウム）124,800円」
出力:
{
  "product_name": "Apple Watch Ultra 2",
  "storage": null,
  "color": "チタニウム",
  "price": 124800
}
```

## 翻訳・変換

### スタイル変換

```markdown
# 推奨: 3-4例（スタイルの違いを明確に）

カジュアルな文章をビジネス文書に変換してください。

例1:
カジュアル: 「明日の会議、参加できる？」
ビジネス: 「明日の会議へのご出席は可能でしょうか。」

例2:
カジュアル: 「資料送ったから見といて」
ビジネス: 「資料をお送りいたしましたので、ご確認いただけますと幸いです。」

例3:
カジュアル: 「それ、ちょっと違うと思う」
ビジネス: 「恐れ入りますが、認識に相違があるように存じます。」

例4:
カジュアル: 「ありがとう！助かった！」
ビジネス: 「誠にありがとうございます。大変助かりました。」
```

### フォーマット変換

```markdown
# 推奨: 3例（入出力形式のバリエーション）

日付を ISO 8601 形式に変換してください。

例1:
入力: 2024年1月15日
出力: 2024-01-15

例2:
入力: 2024/03/20
出力: 2024-03-20

例3:
入力: 令和6年5月1日
出力: 2024-05-01
```

## コード関連

### コード説明

```markdown
# 推奨: 2-3例（異なる複雑性レベル）

コードスニペットを簡潔に説明してください。

例1（シンプル）:
コード:
```python
def add(a, b):
    return a + b
```
説明: 2つの引数を受け取り、その合計を返す関数

例2（中程度）:
コード:
```python
def filter_even(numbers):
    return [n for n in numbers if n % 2 == 0]
```
説明: リストから偶数のみを抽出するリスト内包表記を使用した関数

例3（複雑）:
コード:
```python
async def fetch_all(urls):
    async with aiohttp.ClientSession() as session:
        tasks = [fetch(session, url) for url in urls]
        return await asyncio.gather(*tasks)
```
説明: 複数URLを非同期で並行取得し、すべての結果を返す関数
```

### バグ修正提案

```markdown
# 推奨: 3-4例（異なるバグタイプ）

コードのバグを特定し、修正案を提示してください。

例1（オフバイワンエラー）:
バグコード:
```python
for i in range(len(arr)):
    print(arr[i+1])
```
問題: 配列の最後でインデックス範囲外エラー
修正:
```python
for i in range(len(arr) - 1):
    print(arr[i+1])
```

例2（Null参照）:
バグコード:
```javascript
const name = user.profile.name;
```
問題: userまたはprofileがnullの可能性
修正:
```javascript
const name = user?.profile?.name ?? 'Unknown';
```
```

## ビジネス文書

### 要約生成

```markdown
# 推奨: 2-3例（長さと形式を示範）

長文を3文以内で要約してください。

例1:
原文: 「本プロジェクトは、2024年第1四半期に開始され、
新しい顧客管理システムの導入を目指しています。
現行システムの老朽化と保守コストの増大が背景にあり、
クラウドベースのソリューションへの移行を計画しています。
予算は5000万円で、2024年末までの完了を目標としています。」

要約: 「2024年Q1開始の顧客管理システム刷新プロジェクト。
現行システムの老朽化を理由にクラウド移行を計画。
予算5000万円、2024年末完了予定。」

例2:
原文: 「先週の営業会議では、第3四半期の売上が前年同期比15%増加
したことが報告されました。特に新規顧客からの受注が好調で、
マーケティング施策の効果が表れています。一方で、
原材料費の高騰により利益率は低下傾向にあります。」

要約: 「Q3売上が前年比15%増、新規顧客獲得が好調。
ただし原材料費高騰で利益率は低下傾向。」
```

### レポート構造化

```markdown
# 推奨: 2例（構造の示範）

報告内容を構造化された形式に変換してください。

例1:
報告: 「本日のシステム障害について報告します。14時23分に
ユーザーからログインできないとの報告があり、調査の結果、
認証サーバーのメモリリークが原因と判明しました。
15時10分にサーバー再起動で復旧しました。影響ユーザーは約500名です。」

構造化:
{
  "incident_type": "システム障害",
  "reported_time": "14:23",
  "resolved_time": "15:10",
  "cause": "認証サーバーのメモリリーク",
  "resolution": "サーバー再起動",
  "impact": {
    "users_affected": 500,
    "duration_minutes": 47
  }
}
```

## 対話・チャット

### 応答生成

```markdown
# 推奨: 3-4例（トーンとスタイルを確立）

カスタマーサポートとして丁寧に応答してください。

例1（問い合わせ）:
ユーザー: 「注文のキャンセルはできますか？」
応答: 「ご連絡ありがとうございます。ご注文のキャンセルについて
承ります。注文番号をお教えいただけますでしょうか？」

例2（苦情）:
ユーザー: 「届いた商品が壊れていました」
応答: 「ご不便をおかけし、誠に申し訳ございません。
破損した商品につきまして、交換または返金にて対応させていただきます。
お手数ですが、破損状況のお写真をお送りいただけますでしょうか？」

例3（感謝）:
ユーザー: 「迅速な対応ありがとうございました」
応答: 「こちらこそ、お褒めのお言葉をいただきありがとうございます。
今後もお客様にご満足いただけるサービスを心がけてまいります。
何かございましたら、お気軽にお問い合わせください。」
```

## ドメイン選択ガイド

```yaml
domain_selection:
  text_classification:
    examples_needed: 3-5
    key_focus: "各カテゴリの代表例"
    common_pitfall: "境界ケースの欠如"

  data_extraction:
    examples_needed: 3-5
    key_focus: "入力形式のバリエーション"
    common_pitfall: "欠損データの扱い未定義"

  translation:
    examples_needed: 3-4
    key_focus: "スタイルの一貫性"
    common_pitfall: "例がすべて同じパターン"

  code_tasks:
    examples_needed: 2-4
    key_focus: "複雑性レベルの段階"
    common_pitfall: "例が単純すぎる"

  business_docs:
    examples_needed: 2-3
    key_focus: "形式とトーン"
    common_pitfall: "長すぎる例"

  chat_response:
    examples_needed: 3-4
    key_focus: "状況別の対応パターン"
    common_pitfall: "トーンの不一致"
```
