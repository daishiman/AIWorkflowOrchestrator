# アーキテクチャレビューチェックリスト

## 基本情報

- **レビュー日**: {{date}}
- **レビュー対象**: {{target}}
- **レビュー担当**: @arch-police

---

## 1. レイヤー構造の確認

### 1.1 ディレクトリ構造

- [ ] 4層（shared/core/, shared/infrastructure/, features/, app/）が存在する
- [ ] 各ディレクトリの責務が明確である
- [ ] 不適切なファイル配置がない

### 1.2 shared/core/（Entities層）

- [ ] `entities/`が存在し、ドメインモデルを含む
- [ ] `interfaces/`が存在し、共通インターフェースを定義
- [ ] `errors/`が存在し、ドメインエラーを定義
- [ ] 外部ライブラリへの依存がない

### 1.3 shared/infrastructure/（Interface Adapters層）

- [ ] `database/`が存在し、DB関連コードを含む
- [ ] `ai/`が存在し、AIクライアントを含む
- [ ] `discord/`が存在し、Discord Bot関連を含む
- [ ] `shared/core/`のインターフェースを実装している

### 1.4 features/（Use Cases層）

- [ ] `registry.ts`が存在し、機能を登録している
- [ ] 各機能が独立したディレクトリを持つ
- [ ] 各機能に`schema.ts`、`executor.ts`、`__tests__/`が存在

### 1.5 app/（Frameworks層）

- [ ] API Routesが適切に配置されている
- [ ] プレゼンテーションロジックに特化している

---

## 2. 依存関係の検証

### 2.1 依存方向

- [ ] すべての依存が「外側→内側」の方向である
- [ ] 内側のレイヤーが外側を知らない

### 2.2 shared/core/の独立性

- [ ] Drizzle ORMへの依存がない
- [ ] Zodへの依存がない
- [ ] AI SDKへの依存がない
- [ ] Next.jsへの依存がない
- [ ] Discord.jsへの依存がない

### 2.3 features/の独立性

- [ ] `features/A/`が`features/B/`に依存していない
- [ ] 垂直スライスの独立性が保たれている

### 2.4 循環依存

- [ ] 循環参照が存在しない
- [ ] 依存グラフがDAG（有向非巡回グラフ）である

---

## 3. インターフェース境界

### 3.1 インターフェース定義

- [ ] インターフェースが`shared/core/interfaces/`に定義されている
- [ ] 実装が`shared/infrastructure/`に配置されている
- [ ] 依存性逆転が正しく適用されている

### 3.2 データ変換

- [ ] 外部形式から内部形式への変換がアダプター層で行われている
- [ ] ドメインモデルが外部スキーマに依存していない

---

## 4. SOLID原則の準拠

### 4.1 単一責任の原則（SRP）

- [ ] 各クラス/モジュールが単一の責務を持つ
- [ ] 変更理由が1つだけである

### 4.2 依存性逆転の原則（DIP）

- [ ] 上位モジュールが下位モジュールに直接依存していない
- [ ] 抽象（インターフェース）を介して依存している

---

## 5. 検出された問題

### Critical（即時対応必要）

| #   | 問題 | 場所 | 説明 |
| --- | ---- | ---- | ---- |
| 1   |      |      |      |

### High（早期対応推奨）

| #   | 問題 | 場所 | 説明 |
| --- | ---- | ---- | ---- |
| 1   |      |      |      |

### Medium（計画的に対応）

| #   | 問題 | 場所 | 説明 |
| --- | ---- | ---- | ---- |
| 1   |      |      |      |

### Low（機会があれば対応）

| #   | 問題 | 場所 | 説明 |
| --- | ---- | ---- | ---- |
| 1   |      |      |      |

---

## 6. 是正提案

### 優先度1の対応

1.

### 優先度2の対応

1.

### 優先度3の対応

1.

---

## 7. 総合評価

**アーキテクチャ健全性スコア**: \_\_/100

| カテゴリ             | スコア | コメント |
| -------------------- | ------ | -------- |
| レイヤー構造         | /25    |          |
| 依存関係             | /25    |          |
| インターフェース境界 | /25    |          |
| SOLID準拠            | /25    |          |

---

## 8. 次回レビュー予定

- **予定日**:
- **フォーカス領域**:
