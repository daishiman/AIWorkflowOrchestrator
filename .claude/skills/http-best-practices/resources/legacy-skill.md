---
name: .claude/skills/http-best-practices/SKILL.md
description: |
  HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æ­£ã—ãåŠ¹ç‡çš„ã«æ´»ç”¨ã™ã‚‹ãŸã‚ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹é›†ã€‚

  ğŸ“š ãƒªã‚½ãƒ¼ã‚¹å‚ç…§:
  ã“ã®ã‚¹ã‚­ãƒ«ã«ã¯ä»¥ä¸‹ã®ãƒªã‚½ãƒ¼ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
  å¿…è¦ã«å¿œã˜ã¦è©²å½“ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’å‚ç…§ã—ã¦ãã ã•ã„:

  - `.claude/skills/http-best-practices/resources/status-codes.md`: 2xx/4xx/5xxã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®é©åˆ‡ãªä½¿ã„åˆ†ã‘
  - `.claude/skills/http-best-practices/resources/idempotency.md`: å†ªç­‰æ€§è¨­è¨ˆã¨å†ªç­‰ã‚­ãƒ¼å®Ÿè£…
  - `.claude/skills/http-best-practices/resources/connection-management.md`: Keep-Aliveã€ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒªãƒ³ã‚°ã€HTTP/2æœ€é©åŒ–
  - `.claude/skills/http-best-practices/resources/headers-best-practices.md`: æ¨™æº–ãƒ˜ãƒƒãƒ€ãƒ¼æ´»ç”¨ã¨ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼è¨­è¨ˆ

  å°‚é–€åˆ†é‡:
  - HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰: 2xx/4xx/5xxç³»ã®é©åˆ‡ãªä½¿ã„åˆ†ã‘ã¨ã‚¨ãƒ©ãƒ¼è¨­è¨ˆ
  - å†ªç­‰æ€§è¨­è¨ˆ: å†ªç­‰ã‚­ãƒ¼å®Ÿè£…ã¨ãƒªãƒˆãƒ©ã‚¤ã‚»ãƒ¼ãƒ•ãªAPIè¨­è¨ˆ
  - ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†: Keep-Aliveã€ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒªãƒ³ã‚°ã€HTTP/2ãƒãƒ«ãƒãƒ—ãƒ¬ã‚­ã‚·ãƒ³ã‚°
  - ãƒ˜ãƒƒãƒ€ãƒ¼è¨­è¨ˆ: Content-Type/Acceptäº¤æ¸‰ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¶å¾¡ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼

  ä½¿ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°:
  - RESTful APIã‚’è¨­è¨ˆãƒ»å®Ÿè£…ã™ã‚‹æ™‚
  - HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å®Ÿè£…ã™ã‚‹æ™‚
  - APIé€šä¿¡ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æœ€é©åŒ–ã™ã‚‹æ™‚
  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥ã‚’è¨­è¨ˆã™ã‚‹æ™‚

  Use proactively when designing RESTful APIs, implementing HTTP clients,
  or optimizing API communication.
version: 1.0.0
---

# HTTP Best Practices ã‚¹ã‚­ãƒ«

## æ¦‚è¦

HTTP ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æ­£ã—ãåŠ¹ç‡çš„ã«æ´»ç”¨ã™ã‚‹ãŸã‚ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹é›†ã€‚
ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã€å†ªç­‰æ€§ã€ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã€ãƒ˜ãƒƒãƒ€ãƒ¼è¨­è¨ˆãªã©ã€
å …ç‰¢ãª API é€šä¿¡ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã®çŸ¥è­˜ã‚’æä¾›ã—ã¾ã™ã€‚

## å¯¾è±¡ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

- .claude/agents/gateway-dev.md
- @backend-architect
- .claude/agents/api-doc-writer.md

## å«ã¾ã‚Œã‚‹ãƒªã‚½ãƒ¼ã‚¹

### 1. HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ (resources/status-codes.md)

- 2xx æˆåŠŸç³»ã®é©åˆ‡ãªä½¿ã„åˆ†ã‘
- 4xx ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ã®è¨­è¨ˆ
- 5xx ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¨­è¨ˆ

### 2. å†ªç­‰æ€§è¨­è¨ˆ (resources/idempotency.md)

- HTTP ãƒ¡ã‚½ãƒƒãƒ‰ã¨å†ªç­‰æ€§
- å†ªç­‰ã‚­ãƒ¼ã®å®Ÿè£…
- ãƒªãƒˆãƒ©ã‚¤ã‚»ãƒ¼ãƒ•ãª API è¨­è¨ˆ
- é‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆé˜²æ­¢

### 3. ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ç®¡ç† (resources/connection-management.md)

- Keep-Alive æœ€é©åŒ–
- ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒªãƒ³ã‚°
- HTTP/2 ãƒãƒ«ãƒãƒ—ãƒ¬ã‚­ã‚·ãƒ³ã‚°
- ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­è¨ˆ

### 4. ãƒ˜ãƒƒãƒ€ãƒ¼è¨­è¨ˆ (resources/headers-best-practices.md)

- æ¨™æº–ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ´»ç”¨
- ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼è¨­è¨ˆ
- Content-Type/Accept äº¤æ¸‰
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¶å¾¡ãƒ˜ãƒƒãƒ€ãƒ¼

## ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```
1. è¦ä»¶åˆ†æ
   â”œâ”€â”€ APIã®ç‰¹æ€§ã‚’æŠŠæ¡
   â”œâ”€â”€ å¿…è¦ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç‰¹å®š
   â””â”€â”€ å†ªç­‰æ€§è¦ä»¶ã‚’ç¢ºèª

2. è¨­è¨ˆ
   â”œâ”€â”€ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆ
   â”œâ”€â”€ ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¨­è¨ˆ
   â””â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼æˆ¦ç•¥ç­–å®š

3. å®Ÿè£…
   â”œâ”€â”€ HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š
   â”œâ”€â”€ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
   â””â”€â”€ ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†è¨­å®š

4. æ¤œè¨¼
   â”œâ”€â”€ ã‚¨ãƒ©ãƒ¼ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ
   â”œâ”€â”€ å†ªç­‰æ€§ãƒ†ã‚¹ãƒˆ
   â””â”€â”€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
```

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰é¸æŠ

```typescript
// æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
200 OK           // å–å¾—ãƒ»æ›´æ–°æˆåŠŸï¼ˆãƒœãƒ‡ã‚£ã‚ã‚Šï¼‰
201 Created      // ãƒªã‚½ãƒ¼ã‚¹ä½œæˆæˆåŠŸï¼ˆLocationãƒ˜ãƒƒãƒ€ãƒ¼å¿…é ˆï¼‰
202 Accepted     // éåŒæœŸå‡¦ç†å—ä»˜
204 No Content   // å‰Šé™¤æˆåŠŸï¼ˆãƒœãƒ‡ã‚£ãªã—ï¼‰

// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼
400 Bad Request  // ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã‚¨ãƒ©ãƒ¼
401 Unauthorized // èªè¨¼ã‚¨ãƒ©ãƒ¼
403 Forbidden    // èªå¯ã‚¨ãƒ©ãƒ¼
404 Not Found    // ãƒªã‚½ãƒ¼ã‚¹æœªå­˜åœ¨
409 Conflict     // ç«¶åˆï¼ˆæ¥½è¦³ãƒ­ãƒƒã‚¯å¤±æ•—ãªã©ï¼‰
422 Unprocessable Entity // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
429 Too Many Requests    // ãƒ¬ãƒ¼ãƒˆåˆ¶é™

// ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼
500 Internal Server Error // äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼
502 Bad Gateway           // ä¸Šæµã‚µãƒ¼ãƒ“ã‚¹ã‚¨ãƒ©ãƒ¼
503 Service Unavailable   // ä¸€æ™‚çš„åˆ©ç”¨ä¸å¯
504 Gateway Timeout       // ä¸Šæµã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
```

### å†ªç­‰æ€§è¨­è¨ˆ

```typescript
// å†ªç­‰ã‚­ãƒ¼å®Ÿè£…
interface IdempotentRequest {
  headers: {
    "Idempotency-Key": string; // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”ŸæˆUUID
  };
}

// ã‚µãƒ¼ãƒãƒ¼å´å®Ÿè£…
async function handleIdempotentRequest(
  key: string,
  handler: () => Promise<Response>,
): Promise<Response> {
  // æ—¢å­˜ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯
  const cached = await cache.get(`idempotency:${key}`);
  if (cached) return cached;

  // æ–°è¦å®Ÿè¡Œ
  const response = await handler();

  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜ï¼ˆ24æ™‚é–“ï¼‰
  await cache.set(`idempotency:${key}`, response, 86400);

  return response;
}
```

### ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³æœ€é©åŒ–

```typescript
// Node.js HTTPã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®š
import { Agent } from "http";

const agent = new Agent({
  keepAlive: true, // ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³å†åˆ©ç”¨
  keepAliveMsecs: 30000, // Keep-Aliveé–“éš”
  maxSockets: 50, // æœ€å¤§åŒæ™‚æ¥ç¶šæ•°
  maxFreeSockets: 10, // å¾…æ©Ÿã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³æ•°
  timeout: 30000, // ã‚½ã‚±ãƒƒãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
});

// fetchä½¿ç”¨æ™‚
const response = await fetch(url, {
  agent,
  signal: AbortSignal.timeout(10000),
});
```

## å“è³ªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### è¨­è¨ˆæ™‚

- [ ] å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«é©åˆ‡ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ãŒçµ±ä¸€ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] å†ªç­‰ã§ãªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å†ªç­‰ã‚­ãƒ¼ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ

### å®Ÿè£…æ™‚

- [ ] Content-Type/Accept ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒé©åˆ‡ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ«ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ

### é‹ç”¨æ™‚

- [ ] ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰åˆ¥ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒåé›†ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒªãƒ¼ã‚¯ãŒç›£è¦–ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
- [ ] ã‚¨ãƒ©ãƒ¼ç‡ã«ã‚¢ãƒ©ãƒ¼ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ

## å‚è€ƒè³‡æ–™

- **RFC 7231**: HTTP/1.1 Semantics and Content
- **RFC 7232**: HTTP/1.1 Conditional Requests
- **RFC 9110**: HTTP Semantics
- **ã€RESTful Web APIsã€** Leonard Richardson è‘—

## é–¢é€£ã‚¹ã‚­ãƒ«

- .claude/skills/api-client-patterns/SKILL.md: API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³
- .claude/skills/retry-strategies/SKILL.md: ãƒªãƒˆãƒ©ã‚¤ãƒ»ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼
- .claude/skills/rate-limiting/SKILL.md: ãƒ¬ãƒ¼ãƒˆåˆ¶é™å®Ÿè£…
