---
description: |
  ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ç›£æŸ»ã‚’å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã€‚

  ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å•é¡Œãƒ»å¤ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ¤œå‡ºã—ã€
  å¯¾å‡¦æ–¹æ³•ã‚’å«ã‚€åŒ…æ‹¬çš„ãªç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚

  ğŸ¤– èµ·å‹•ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:
  - Phase 2: `.claude/agents/dep-mgr.md` - ä¾å­˜é–¢ä¿‚ç›£æŸ»å°‚é–€
  - Phase 3: `.claude/agents/sec-auditor.md` - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡å°‚é–€

  ğŸ“š åˆ©ç”¨å¯èƒ½ã‚¹ã‚­ãƒ«ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå‚ç…§ï¼‰:
  - `.claude/skills/dependency-auditing/SKILL.md` - pnpm auditè§£æã€è„†å¼±æ€§è©•ä¾¡
  - `.claude/skills/vulnerability-assessment/SKILL.md` - CVEè©•ä¾¡ã€CVSS ã‚¹ã‚³ã‚¢åˆ¤å®š
  - `.claude/skills/license-compliance/SKILL.md` - ãƒ©ã‚¤ã‚»ãƒ³ã‚¹äº’æ›æ€§ãƒã‚§ãƒƒã‚¯

  âš™ï¸ ã“ã®ã‚³ãƒãƒ³ãƒ‰ã®è¨­å®š:
  - argument-hint: ãªã—
  - allowed-tools: ç›£æŸ»å®Ÿè¡Œã¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆç”¨
    â€¢ Task: dep-mgr/sec-auditorã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèµ·å‹•ç”¨
    â€¢ Bash(pnpm audit*|pnpm audit*): ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»å°‚ç”¨
    â€¢ Write(docs/**): ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆä¿å­˜ç”¨
  - model: sonnetï¼ˆæ¨™æº–çš„ãªç›£æŸ»ã‚¿ã‚¹ã‚¯ï¼‰

  ğŸ“‹ æˆæœç‰©:
  - ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆï¼ˆ`docs/security/dependency-audit-report.md`ï¼‰
  - è„†å¼±æ€§ä¸€è¦§ï¼ˆCritical/High/Medium/Lowï¼‰
  - ãƒ©ã‚¤ã‚»ãƒ³ã‚¹äº’æ›æ€§ãƒ¬ãƒãƒ¼ãƒˆ
  - ä¿®æ­£ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³

  ğŸ¯ ç›£æŸ»å¯¾è±¡:
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ï¼ˆCVEã€CVSS ã‚¹ã‚³ã‚¢ï¼‰
  - ãƒ©ã‚¤ã‚»ãƒ³ã‚¹äº’æ›æ€§
  - å¤ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆEOLã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹çŠ¶æ³ï¼‰
  - é‡è¤‡ä¾å­˜é–¢ä¿‚

  ãƒˆãƒªã‚¬ãƒ¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: audit dependencies, security scan, è„†å¼±æ€§ç›£æŸ», ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
argument-hint: ""
allowed-tools:
  - Task
  - Bash(pnpm audit*)
  - Write(docs/**)
model: sonnet
---

# ä¾å­˜é–¢ä¿‚ç›£æŸ»

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ã¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å•é¡Œã‚’ç›£æŸ»ã—ã¾ã™ã€‚

## ğŸ“‹ å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

### Phase 1: ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼æ¤œå‡º

```bash
if [ -f "pnpm-lock.yaml" ]; then
  pkg_manager="pnpm"
elif [ -f "package-lock.json" ]; then
  pkg_manager="pnpm"
else
  ã‚¨ãƒ©ãƒ¼: ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“
fi
```

### Phase 2: dep-mgrã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’èµ·å‹•ï¼ˆè„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ï¼‰

**ä½¿ç”¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `.claude/agents/dep-mgr.md`

**ä¾é ¼å†…å®¹**:
```markdown
ä¾å­˜é–¢ä¿‚ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

**è¦ä»¶**:
1. è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³å®Ÿè¡Œ:
   ```bash
   pnpm audit --json > audit-result.json
   ```

2. è„†å¼±æ€§åˆ†é¡:
   - **Critical**: å³åº§ã®å¯¾å¿œå¿…é ˆï¼ˆãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œç­‰ï¼‰
   - **High**: æ—©æ€¥ãªå¯¾å¿œå¿…è¦ï¼ˆæ¨©é™æ˜‡æ ¼ç­‰ï¼‰
   - **Medium**: è¨ˆç”»çš„å¯¾å¿œï¼ˆæƒ…å ±æ¼æ´©ãƒªã‚¹ã‚¯ç­‰ï¼‰
   - **Low**: æ³¨æ„ãŒå¿…è¦ï¼ˆè»½å¾®ãªè„†å¼±æ€§ï¼‰

3. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯:
   - GPLç³»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®æ¤œå‡ºï¼ˆã‚³ãƒ”ãƒ¼ãƒ¬ãƒ•ãƒˆï¼‰
   - å•†ç”¨ä¸å¯ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®æ¤œå‡º
   - ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å¤‰æ›´ã®è¿½è·¡

**ã‚¹ã‚­ãƒ«å‚ç…§**: dependency-auditing, vulnerability-assessment

**æˆæœç‰©**: è„†å¼±æ€§ä¸€è¦§ï¼ˆJSON + Markdownï¼‰
```

### Phase 3: sec-auditorã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’èµ·å‹•ï¼ˆè©•ä¾¡ãƒ»æ¨å¥¨ï¼‰

**ä½¿ç”¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: `.claude/agents/sec-auditor.md`

**ä¾é ¼å†…å®¹**:
```markdown
è„†å¼±æ€§ç›£æŸ»çµæœã‚’è©•ä¾¡ã—ã€ä¿®æ­£ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

**å…¥åŠ›**: ${audit-result.json}

**è¦ä»¶**:
1. ãƒªã‚¹ã‚¯è©•ä¾¡:
   - CVSS ã‚¹ã‚³ã‚¢ã«åŸºã¥ãå„ªå…ˆåº¦æ±ºå®š
   - å®Ÿéš›ã®å½±éŸ¿ç¯„å›²è©•ä¾¡ï¼ˆæœ¬ç•ªç’°å¢ƒãƒ»é–‹ç™ºç’°å¢ƒï¼‰
   - æ‚ªç”¨å¯èƒ½æ€§è©•ä¾¡

2. ä¿®æ­£ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:
   ```markdown
   ## ä¿®æ­£ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå„ªå…ˆåº¦é †ï¼‰

   ### Criticalï¼ˆå³åº§å¯¾å¿œï¼‰
   1. [package-name]@[version] â†’ [fixed-version]
      - CVE: CVE-2024-XXXXX
      - CVSS: 9.8ï¼ˆCriticalï¼‰
      - å½±éŸ¿: ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œ
      - ä¿®æ­£æ–¹æ³•: `pnpm add [package-name]@[fixed-version]`

   ### Highï¼ˆ24æ™‚é–“ä»¥å†…ï¼‰
   [...]

   ### Mediumï¼ˆ1é€±é–“ä»¥å†…ï¼‰
   [...]
   ```

3. ä»£æ›¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ææ¡ˆï¼ˆä¿®æ­£ç‰ˆãŒãªã„å ´åˆï¼‰

**ã‚¹ã‚­ãƒ«å‚ç…§**: vulnerability-assessment, security-best-practices

**æˆæœç‰©**: ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆï¼ˆMarkdownï¼‰
```

### Phase 4: å®Œäº†å ±å‘Šã¨ãƒ¬ãƒãƒ¼ãƒˆä¿å­˜

```markdown
## ä¾å­˜é–¢ä¿‚ç›£æŸ»å®Œäº†

ç›£æŸ»æ—¥æ™‚: ${date}

### è„†å¼±æ€§ã‚µãƒãƒªãƒ¼
- Critical: ${critical_count}ä»¶
- High: ${high_count}ä»¶
- Medium: ${medium_count}ä»¶
- Low: ${low_count}ä»¶

### ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å•é¡Œ
- GPLç³»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹: ${gpl_count}ä»¶
- å•†ç”¨ä¸å¯: ${commercial_count}ä»¶

### æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
1. Critical è„†å¼±æ€§ã®å³åº§ä¿®æ­£
2. High è„†å¼±æ€§ã®24æ™‚é–“ä»¥å†…ä¿®æ­£
3. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å•é¡Œã®ç¢ºèª

ãƒ¬ãƒãƒ¼ãƒˆ: docs/security/dependency-audit-report.md
```

## ä½¿ç”¨ä¾‹

### åŸºæœ¬çš„ãªä½¿ç”¨

```bash
/ai:audit-dependencies
```

è‡ªå‹•å®Ÿè¡Œ:
1. `pnpm audit` ã§ã‚¹ã‚­ãƒ£ãƒ³
2. è„†å¼±æ€§åˆ†é¡ï¼ˆCritical/High/Medium/Lowï¼‰
3. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯
4. ä¿®æ­£ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ç”Ÿæˆ
5. ãƒ¬ãƒãƒ¼ãƒˆä¿å­˜

## ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆä¾‹

```markdown
# ä¾å­˜é–¢ä¿‚ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆ

ç›£æŸ»æ—¥æ™‚: 2025-01-15 10:00:00

## ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

- ç·ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•°: 342
- è„†å¼±æ€§: 5ä»¶ï¼ˆCritical: 1, High: 2, Medium: 2ï¼‰
- ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å•é¡Œ: 0ä»¶

## Criticalè„†å¼±æ€§ï¼ˆå³åº§å¯¾å¿œï¼‰

### 1. axios@0.21.1 â†’ CVE-2021-3749
- **CVSS**: 9.8ï¼ˆCriticalï¼‰
- **å½±éŸ¿**: SSRFï¼ˆServer-Side Request Forgeryï¼‰
- **æ‚ªç”¨å¯èƒ½æ€§**: é«˜ï¼ˆå…¬é–‹ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚ã‚Šï¼‰
- **ä¿®æ­£æ–¹æ³•**:
  ```bash
  pnpm add axios@1.6.0
  ```
- **æ¤œè¨¼**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã€æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤

## Highè„†å¼±æ€§ï¼ˆ24æ™‚é–“ä»¥å†…ï¼‰

### 2. semver@6.3.0 â†’ CVE-2022-25883
- **CVSS**: 7.5ï¼ˆHighï¼‰
- **å½±éŸ¿**: ReDoSï¼ˆRegular Expression Denial of Serviceï¼‰
- **ä¿®æ­£æ–¹æ³•**:
  ```bash
  pnpm add semver@7.5.4
  ```

## Mediumè„†å¼±æ€§ï¼ˆ1é€±é–“ä»¥å†…ï¼‰

[...]

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ

- MIT: 320ä»¶ï¼ˆå•é¡Œãªã—ï¼‰
- Apache-2.0: 18ä»¶ï¼ˆå•é¡Œãªã—ï¼‰
- ISC: 4ä»¶ï¼ˆå•é¡Œãªã—ï¼‰
- GPL-3.0: 0ä»¶

## æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

1. âœ… Criticalè„†å¼±æ€§ã®å³åº§ä¿®æ­£ï¼ˆæœ¬æ—¥ä¸­ï¼‰
2. âœ… Highè„†å¼±æ€§ã®24æ™‚é–“ä»¥å†…ä¿®æ­£
3. â³ Mediumè„†å¼±æ€§ã®è¨ˆç”»çš„ä¿®æ­£ï¼ˆä»Šé€±ä¸­ï¼‰
4. âœ… å®šæœŸç›£æŸ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®šï¼ˆé€±æ¬¡ï¼‰
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ä¿®æ­£ç‰ˆãŒå­˜åœ¨ã—ãªã„

**è§£æ±ºç­–**:
```bash
# ä»£æ›¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ¤œç´¢
pnpm search [alternative-package]

# ã¾ãŸã¯ä¸€æ™‚çš„ãªç·©å’Œç­–
# package.json ã® resolutions/overrides ã§å¼·åˆ¶ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š
```

### false positiveï¼ˆèª¤æ¤œå‡ºï¼‰

**è§£æ±ºç­–**:
```bash
# audit ã®ç„¡è¦–è¨­å®šï¼ˆæœ€çµ‚æ‰‹æ®µï¼‰
pnpm audit --audit-level=high  # Mediumä»¥ä¸‹ã‚’ç„¡è¦–
```

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### å®šæœŸç›£æŸ»ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

```bash
# âœ… æ¨å¥¨: é€±æ¬¡ã¾ãŸã¯æœˆæ¬¡ã§å®šæœŸå®Ÿè¡Œ
/ai:audit-dependencies

# CI/CD çµ±åˆ
# .github/workflows/security-audit.yml
# schedule:
#   - cron: '0 9 * * 1'  # æ¯é€±æœˆæ›œ9æ™‚
```

### ç›£æŸ»å¾Œã®ä¿®æ­£ãƒ•ãƒ­ãƒ¼

```bash
# 1. ç›£æŸ»å®Ÿè¡Œ
/ai:audit-dependencies

# 2. Critical/High ã‚’å³åº§ä¿®æ­£
/ai:update-dependencies patch

# 3. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pnpm test

# 4. ã‚³ãƒŸãƒƒãƒˆ
git commit -m "fix(security): resolve critical vulnerabilities"
```

## å‚ç…§

- dep-mgr: `.claude/agents/dep-mgr.md`
- sec-auditor: `.claude/agents/sec-auditor.md`
- dependency-auditing: `.claude/skills/dependency-auditing/SKILL.md`
