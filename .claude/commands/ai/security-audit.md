---
description: |
  åŒ…æ‹¬çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚’å®Ÿæ–½ã—ã€è„†å¼±æ€§ã€æ¨©é™è¨­å®šã€èªè¨¼ãƒ»èªå¯ã®å•é¡Œã‚’
  æ¤œå‡ºã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚

  ğŸ¤– èµ·å‹•ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆã‚¹ã‚³ãƒ¼ãƒ—åˆ¥ï¼‰:
  - Phase 1-3 (all): `.claude/agents/sec-auditor.md` - å…¨é ˜åŸŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
  - Phase 2 (auth): `.claude/agents/auth-specialist.md` - èªè¨¼ãƒ»èªå¯ç›£æŸ»
  - Phase 2 (api): `.claude/agents/sec-auditor.md` - APIã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
  - Phase 2 (database): `.claude/agents/dba-mgr.md` - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»

  ğŸ“š åˆ©ç”¨å¯èƒ½ã‚¹ã‚­ãƒ«ï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå‚ç…§ï¼‰:
  **sec-auditorç”¨:**
  - `.claude/skills/authentication-authorization-security/SKILL.md` - èªè¨¼ãƒ»èªå¯è©•ä¾¡
  - `.claude/skills/cryptographic-practices/SKILL.md` - æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€éµç®¡ç†
  - `.claude/skills/security-configuration-review/SKILL.md` - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã€CORS
  - `.claude/skills/code-static-analysis-security/SKILL.md` - SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã€XSSæ¤œå‡º
  - `.claude/skills/rate-limiting/SKILL.md` - DoSå¯¾ç­–ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™
  - `.claude/skills/input-sanitization/SKILL.md` - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¿ãƒ³ãƒ‘ãƒªãƒ³ã‚°é˜²æ­¢
  - `.claude/skills/security-reporting/SKILL.md` - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

  **auth-specialistç”¨:**
  - `.claude/skills/oauth2-flows/SKILL.md` - OAuth 2.0ãƒ•ãƒ­ãƒ¼ã€PKCE
  - `.claude/skills/session-management/SKILL.md` - JWTã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
  - `.claude/skills/nextauth-patterns/SKILL.md` - NextAuth.jsè¨­å®šãƒ‘ã‚¿ãƒ¼ãƒ³

  âš™ï¸ ã“ã®ã‚³ãƒãƒ³ãƒ‰ã®è¨­å®š:
  - argument-hint: "[scope: all|auth|api|database]"ï¼ˆç›£æŸ»ã‚¹ã‚³ãƒ¼ãƒ—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: allï¼‰
  - allowed-tools: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆç”¨
    â€¢ Read: ã‚³ãƒ¼ãƒ‰ç¢ºèªã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«åˆ†æç”¨
    â€¢ Grep: è„†å¼±æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢ç”¨
    â€¢ Bash: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œç”¨
    â€¢ Write: ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆç”¨
  - model: opusï¼ˆè¤‡é›‘ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æãŒå¿…è¦ï¼‰

  ğŸ“‹ æˆæœç‰©:
  - `docs/security/security-audit-report.md`ï¼ˆåŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆï¼‰
  - OWASP Top 10ãƒã‚§ãƒƒã‚¯çµæœ
  - è„†å¼±æ€§ä¸€è¦§ã¨ä¿®æ­£ææ¡ˆ

  ãƒˆãƒªã‚¬ãƒ¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: security audit, ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ», OWASP, æ¨©é™ãƒã‚§ãƒƒã‚¯, èªè¨¼ç›£æŸ»
argument-hint: "[scope: all|auth|api|database]"
allowed-tools:
  - Read
  - Grep
  - Bash
  - Write
model: opus
---

# /ai:security-audit - åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»

**ç›®çš„**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã¾ãŸã¯ã‚¹ã‚³ãƒ¼ãƒ—æŒ‡å®šé ˜åŸŸã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚’å®Ÿæ–½ã—ã€OWASP Top 10ã€æ¨©é™è¨­å®šã€èªè¨¼ãƒ»èªå¯ã®è„†å¼±æ€§ã‚’æ¤œå‡ºã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚

**ãƒˆãƒªã‚¬ãƒ¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰**: security audit, ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ», è„†å¼±æ€§æ¤œæŸ», ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼, OWASP, æ¨©é™ãƒã‚§ãƒƒã‚¯, èªè¨¼ç›£æŸ», ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³

---

## ğŸ“‹ å¼•æ•°ä»•æ§˜

- **$1 (scope)**: ç›£æŸ»ã‚¹ã‚³ãƒ¼ãƒ—
  - `all` (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ): å…¨é ˜åŸŸã‚’ç›£æŸ»
  - `auth`: èªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ ã®ã¿
  - `api`: APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
  - `database`: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã¨ã‚¯ã‚¨ãƒª

**ä½¿ç”¨ä¾‹**:
```bash
/ai:security-audit
/ai:security-audit auth
/ai:security-audit api
/ai:security-audit database
```

---

## ğŸ¯ å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ï¼ˆ3ãƒ•ã‚§ãƒ¼ã‚ºæ§‹é€ ï¼‰

### Phase 1: æº–å‚™ãƒ»åˆ†æ

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèµ·å‹•**:
```
`.claude/agents/sec-auditor.md` ã‚’èµ·å‹•ã—ã€ä»¥ä¸‹ã‚’ä¾é ¼:
- ã‚¹ã‚³ãƒ¼ãƒ—: $1 (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: all)
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®åˆ†æ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»å¯¾è±¡ã®ç‰¹å®š
- OWASP Top 10 ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆæº–å‚™
```

**ã‚¹ã‚­ãƒ«å‚ç…§** (Phase 1):
- `.claude/skills/owasp-top-10/SKILL.md`: OWASP Top 10 è„†å¼±æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³
- `.claude/skills/vulnerability-scanning/SKILL.md`: è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³æ‰‹æ³•
- `.claude/skills/project-architecture-integration/SKILL.md`: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ç†è§£

**æœŸå¾…æˆæœç‰©**:
- ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§
- ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- ãƒªã‚¹ã‚¯è©•ä¾¡åŸºæº–

---

### Phase 2: ç›£æŸ»å®Ÿè¡Œ

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèµ·å‹•**:
```
ã‚¹ã‚³ãƒ¼ãƒ—ã«å¿œã˜ã¦é©åˆ‡ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’èµ·å‹•:

ã€auth ã‚¹ã‚³ãƒ¼ãƒ—ã€‘
`.claude/agents/auth-specialist.md` ã‚’èµ·å‹•ã—ã€ä»¥ä¸‹ã‚’ä¾é ¼:
- èªè¨¼ãƒ•ãƒ­ãƒ¼æ¤œè¨¼
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒã‚§ãƒƒã‚¯
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒªã‚·ãƒ¼ç¢ºèª
- OAuth/JWTå®Ÿè£…ãƒ¬ãƒ“ãƒ¥ãƒ¼
- ã‚¹ã‚­ãƒ«å‚ç…§: `.claude/skills/oauth2-flows/SKILL.md`
- ã‚¹ã‚­ãƒ«å‚ç…§: `.claude/skills/nextauth-patterns/SKILL.md`

ã€api ã‚¹ã‚³ãƒ¼ãƒ—ã€‘
`.claude/agents/sec-auditor.md` ã‚’èµ·å‹•ã—ã€ä»¥ä¸‹ã‚’ä¾é ¼:
- APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®æ¨©é™ãƒã‚§ãƒƒã‚¯
- å…¥åŠ›æ¤œè¨¼ã®ç¢ºèª
- CSRF/XSSå¯¾ç­–ãƒ¬ãƒ“ãƒ¥ãƒ¼
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™å®Ÿè£…ç¢ºèª
- ã‚¹ã‚­ãƒ«å‚ç…§: `.claude/skills/rate-limiting-strategies/SKILL.md`

ã€database ã‚¹ã‚³ãƒ¼ãƒ—ã€‘
`.claude/agents/sec-auditor.md` ã‚’èµ·å‹•ã—ã€ä»¥ä¸‹ã‚’ä¾é ¼:
- SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ç¢ºèª
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¨©é™ãƒ¬ãƒ“ãƒ¥ãƒ¼
- ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ãƒã‚§ãƒƒã‚¯
- ã‚¹ã‚­ãƒ«å‚ç…§: `.claude/skills/vulnerability-scanning/SKILL.md`

ã€all ã‚¹ã‚³ãƒ¼ãƒ—ã€‘
ä¸Šè¨˜ã™ã¹ã¦ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’é †æ¬¡èµ·å‹•
```

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¾é ¼å†…å®¹**:
- è©²å½“ã‚¹ã‚³ãƒ¼ãƒ—ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§æ¤œå‡º
- pnpm audit / pnpm audit å®Ÿè¡Œ
- ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
- ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½

**æœŸå¾…æˆæœç‰©**:
- æ¤œå‡ºã•ã‚ŒãŸè„†å¼±æ€§ãƒªã‚¹ãƒˆï¼ˆé‡å¤§åº¦ä»˜ãï¼‰
- ä¾å­˜é–¢ä¿‚ç›£æŸ»çµæœ
- ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰€è¦‹

---

### Phase 3: ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ»æ¤œè¨¼

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèµ·å‹•**:
```
`.claude/agents/sec-auditor.md` ã‚’èµ·å‹•ã—ã€ä»¥ä¸‹ã‚’ä¾é ¼:
- ç›£æŸ»çµæœã®é›†ç´„
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- ä¿®æ­£æ¨å¥¨äº‹é …ã®æç¤º
- å„ªå…ˆåº¦ä»˜ã‘
```

**ã‚¹ã‚­ãƒ«å‚ç…§** (Phase 3):
- `.claude/skills/best-practices-curation/SKILL.md`: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- `.claude/skills/tool-permission-management/SKILL.md`: æ¨©é™è¨­å®šæœ€é©åŒ–

**æˆæœç‰©**:
- `docs/security/audit-report-[YYYYMMDD].md`: åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆ
  - Executive Summary
  - æ¤œå‡ºã•ã‚ŒãŸè„†å¼±æ€§ï¼ˆé‡å¤§åº¦åˆ¥ï¼‰
  - ä¿®æ­£æ¨å¥¨äº‹é …ï¼ˆå„ªå…ˆåº¦é †ï¼‰
  - ä¾å­˜é–¢ä¿‚ç›£æŸ»çµæœ
  - æ¬¡å›ç›£æŸ»ã®æ¨å¥¨äº‹é …

---

## ğŸ” æ¤œè¨¼é …ç›®

å®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„:

- [ ] ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆãŒ `docs/security/` ã«ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [ ] é‡å¤§åº¦ï¼ˆCritical/High/Medium/Lowï¼‰ãŒæ˜è¨˜ã•ã‚Œã¦ã„ã‚‹
- [ ] å„è„†å¼±æ€§ã«ä¿®æ­£æ¨å¥¨äº‹é …ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹
- [ ] pnpm audit / pnpm audit ã®çµæœãŒå«ã¾ã‚Œã¦ã„ã‚‹
- [ ] æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ãŒæ˜ç¢ºã§ã‚ã‚‹

---

## ğŸ“š é–¢é€£ã‚³ãƒãƒ³ãƒ‰

- `/ai:scan-vulnerabilities` - è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ã®ã¿å®Ÿæ–½
- `/ai:setup-auth` - èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…
- `/ai:manage-secrets` - æ©Ÿå¯†æƒ…å ±ç®¡ç†
- `/ai:setup-rate-limiting` - ãƒ¬ãƒ¼ãƒˆåˆ¶é™å®Ÿè£…

---

## ğŸ“ å‚è€ƒè³‡æ–™

**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä»•æ§˜**:
- `.claude/agents/sec-auditor.md`: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
- `.claude/agents/auth-specialist.md`: èªè¨¼å°‚é–€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

**ã‚¹ã‚­ãƒ«ä»•æ§˜**:
- `.claude/skills/owasp-top-10/SKILL.md`: OWASP Top 10 è„†å¼±æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³
- `.claude/skills/vulnerability-scanning/SKILL.md`: è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³æ‰‹æ³•
- `.claude/skills/oauth2-flows/SKILL.md`: OAuth 2.0 ãƒ•ãƒ­ãƒ¼å®Ÿè£…
- `.claude/skills/nextauth-patterns/SKILL.md`: NextAuth.js ãƒ‘ã‚¿ãƒ¼ãƒ³
- `.claude/skills/rate-limiting-strategies/SKILL.md`: ãƒ¬ãƒ¼ãƒˆåˆ¶é™æˆ¦ç•¥
